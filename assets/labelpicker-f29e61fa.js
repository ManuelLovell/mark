import{a as k,O as r,C as T,b as B,S as x}from"./style-edbabba7.js";class v{static async UpdateLabel(o,c,p){const y=k(o.id,c.Id),f=await r.scene.items.getItems([y]),E="#242424",u=parseInt(p);let s=0;if(f.length===0){const n=await r.scene.items.getItems(i=>i.attachedTo===o.id&&i.type==="LABEL"&&i.style.pointerDirection===L(c.Direction));if(n.length>0){for(let i=0;i<n.length+1;i++)if(!n.find(h=>h.metadata[`${T.EXTENSIONID}/place`].placement===i)){s=i;break}}let I={};I[`${T.EXTENSIONID}/place`]={placement:s};const t=B().fillColor(c.Color).plainText(c.Name).strokeWidth(5).build();t.id=y,t.type="LABEL",t.attachedTo=o.id,t.visible=!!o.visible,t.locked=!0,t.position={x:o.position.x,y:o.position.y},t.metadata=I;let a,d=15,l=15;c.Direction=="Top"&&(t.position.y-=o.image.height*o.scale.y/4,a="DOWN",n.length>0&&s!==0&&(t.position.y-=15,t.position.y-=u*s)),c.Direction=="Bottom"&&(t.position.y+=o.image.height*o.scale.y/4,a="UP",n.length>0&&s!==0&&(t.position.y+=15,t.position.y+=u*s)),c.Direction=="Right"&&(t.position.x+=o.image.width*o.scale.x/4,a="LEFT",n.length>0&&s!==0&&(t.position.y+=u*s)),c.Direction=="Left"&&(t.position.x-=o.image.width*o.scale.x/4,a="RIGHT",n.length>0&&s!==0&&(t.position.y-=u*s)),n.length>0&&s!==0&&(d=0,l=0),t.style={backgroundColor:E,backgroundOpacity:.85,pointerDirection:a,pointerWidth:l,pointerHeight:d,cornerRadius:10},await r.scene.items.addItems([t])}else await r.scene.items.deleteItems([y]);function L(n){switch(n){case"Top":return"DOWN";case"Bottom":return"UP";case"Right":return"LEFT";case"Left":return"RIGHT";default:throw new Error("Invalid direction")}}}}r.onReady(async()=>{document.documentElement.style.borderRadius="16px",document.documentElement.style.height="100%";const w=window.location.search,o=new URLSearchParams(w),c=o.get("targetid"),p=o.get("multi"),y=p?c.split(","):[];let f=[];const E=await r.scene.items.getItems(p?y:[c]);p||(f=await r.scene.items.getItems(t=>t.attachedTo===E[0].id&&t.type==="LABEL"));const u=await r.theme.getTheme();x(u,document),r.theme.onChange(t=>{x(t,document)});const n=(await r.room.getMetadata())[`${T.EXTENSIONID}/metadata_marks`]?.saveData;if(n&&n.Labels?.length>0){let t=function(e){e==="#1"?(a.style.display="",d.style.display="none",l.style.display="none"):e==="#2"?(a.style.display="none",d.style.display="",l.style.display="none"):(a.style.display="none",d.style.display="none",l.style.display="")};const a=document.querySelector("#label-list1"),d=document.querySelector("#label-list2"),l=document.querySelector("#label-list3"),i=document.createElement("button");i.className="categoryButton",i.onclick=()=>t("#1");const g=document.createElement("button");g.className="categoryButton",g.onclick=()=>t("#2");const h=document.createElement("button");h.className="categoryButton",h.onclick=()=>t("#3");const b=document.querySelector(".footered");b.appendChild(i),b.appendChild(g),b.appendChild(h),n.Groups.forEach(e=>{switch(e.Num){case"#1":i.innerText=e.Name;break;case"#2":g.innerText=e.Name;break;case"#3":h.innerText=e.Name;break;default:throw new Error("Invalid Group")}}),n.Labels.forEach(e=>{if(e.Active){const N=f.find(S=>S.text.plainText===e.Name),m=document.createElement("button");m.id=`toggle-${e.Id}`,m.className=`group1${N?" highlight":""}`,m.value=e.Name,m.title=e.Name,m.textContent=e.Name,e.Group==="#1"?a.appendChild(m):e.Group==="#2"?d.appendChild(m):l.appendChild(m)}}),document.querySelectorAll(".group1").forEach(e=>{e.addEventListener("click",async N=>await I(N.currentTarget))}),t("#1")}else document.querySelector("#label-list1").innerHTML=`
        <div>
        No labels found.
        </div>`;async function I(t){const a=t.id.substring(7),d=n.Labels.find(l=>l.Id===a);p||(t.className=t.className==="group1"?"group1 highlight":"group1"),E.forEach(async l=>{await v.UpdateLabel(l,d,n.Distance)})}});
