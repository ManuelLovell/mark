import{O as re,C as ee,i as Sr,L as Br,S as Vt,a as Ir,G as Nr,b as Mr,H as Rr,R as Hr}from"./style-c5bdc37e.js";function Pr(e){return e.type==="IMAGE"}const $r="com.battle-system.mark-menu";function jr(){re.contextMenu.create({id:`${$r}/context-menu`,icons:[{icon:"/tag1.svg",label:"Mark It",filter:{some:[{key:"layer",value:"CHARACTER",coordinator:"||"},{key:"layer",value:"MOUNT"}]}}],async onClick(e,t){await re.popover.open({id:ee.LABELSID,url:"/labelpicker.html",height:250,width:300,anchorElementId:t})},embed:{url:"/labelpicker.html?contextmenu=true",height:200}})}function Fr(){re.broadcast.onMessage(ee.MARKCONNECT,async e=>{if(Array.isArray(e.data)){const t=e.data;if(t.length>0){const r=await re.room.getMetadata(),a=await re.scene.items.getItems(l=>Pr(l)),f=r[`${ee.EXTENSIONID}/metadata_marks`]?.saveData;let u=f.Distance??"36",p=f.Opacity??"85";for(const l of t){const h={Active:1,Direction:l.Direction??"Top",Color:Sr(l.Color)?l.Color:"#FFFFFF",Group:"#1",Name:l.LabelName,Id:`TID-${l.LabelName}`},v=f.Labels.find(C=>C.Name?.toLowerCase().includes(l.LabelName?.toLowerCase()));v&&(h.Name=v.Name,h.Direction=v.Direction,h.Color=v.Color,h.Id=v.Id);const T=a.find(C=>C.id===l.TokenId);T&&await Br.UpdateLabel(T,h,u,p,ee.DEFAULTSTROKE,l.Show)}}}})}var ne="top",pe="bottom",de="right",ae="left",It="auto",it=[ne,pe,de,ae],ze="start",nt="end",Ur="clippingParents",sr="viewport",Qe="popper",Vr="reference",Wt=it.reduce(function(e,t){return e.concat([t+"-"+ze,t+"-"+nt])},[]),lr=[].concat(it,[It]).reduce(function(e,t){return e.concat([t,t+"-"+ze,t+"-"+nt])},[]),Wr="beforeRead",Gr="read",qr="afterRead",_r="beforeMain",Yr="main",Xr="afterMain",zr="beforeWrite",Kr="write",Jr="afterWrite",Zr=[Wr,Gr,qr,_r,Yr,Xr,zr,Kr,Jr];function Ae(e){return e?(e.nodeName||"").toLowerCase():null}function oe(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function je(e){var t=oe(e).Element;return e instanceof t||e instanceof Element}function fe(e){var t=oe(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function Nt(e){if(typeof ShadowRoot>"u")return!1;var t=oe(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Qr(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var a=t.styles[r]||{},i=t.attributes[r]||{},f=t.elements[r];!fe(f)||!Ae(f)||(Object.assign(f.style,a),Object.keys(i).forEach(function(u){var p=i[u];p===!1?f.removeAttribute(u):f.setAttribute(u,p===!0?"":p)}))})}function en(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(a){var i=t.elements[a],f=t.attributes[a]||{},u=Object.keys(t.styles.hasOwnProperty(a)?t.styles[a]:r[a]),p=u.reduce(function(l,h){return l[h]="",l},{});!fe(i)||!Ae(i)||(Object.assign(i.style,p),Object.keys(f).forEach(function(l){i.removeAttribute(l)}))})}}const cr={name:"applyStyles",enabled:!0,phase:"write",fn:Qr,effect:en,requires:["computeStyles"]};function xe(e){return e.split("-")[0]}var $e=Math.max,dt=Math.min,Ke=Math.round;function kt(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function ur(){return!/^((?!chrome|android).)*safari/i.test(kt())}function Je(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var a=e.getBoundingClientRect(),i=1,f=1;t&&fe(e)&&(i=e.offsetWidth>0&&Ke(a.width)/e.offsetWidth||1,f=e.offsetHeight>0&&Ke(a.height)/e.offsetHeight||1);var u=je(e)?oe(e):window,p=u.visualViewport,l=!ur()&&r,h=(a.left+(l&&p?p.offsetLeft:0))/i,v=(a.top+(l&&p?p.offsetTop:0))/f,T=a.width/i,C=a.height/f;return{width:T,height:C,top:v,right:h+T,bottom:v+C,left:h,x:h,y:v}}function Mt(e){var t=Je(e),r=e.offsetWidth,a=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-a)<=1&&(a=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:a}}function fr(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Nt(r)){var a=t;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function Te(e){return oe(e).getComputedStyle(e)}function tn(e){return["table","td","th"].indexOf(Ae(e))>=0}function Se(e){return((je(e)?e.ownerDocument:e.document)||window.document).documentElement}function ht(e){return Ae(e)==="html"?e:e.assignedSlot||e.parentNode||(Nt(e)?e.host:null)||Se(e)}function Gt(e){return!fe(e)||Te(e).position==="fixed"?null:e.offsetParent}function rn(e){var t=/firefox/i.test(kt()),r=/Trident/i.test(kt());if(r&&fe(e)){var a=Te(e);if(a.position==="fixed")return null}var i=ht(e);for(Nt(i)&&(i=i.host);fe(i)&&["html","body"].indexOf(Ae(i))<0;){var f=Te(i);if(f.transform!=="none"||f.perspective!=="none"||f.contain==="paint"||["transform","perspective"].indexOf(f.willChange)!==-1||t&&f.willChange==="filter"||t&&f.filter&&f.filter!=="none")return i;i=i.parentNode}return null}function ot(e){for(var t=oe(e),r=Gt(e);r&&tn(r)&&Te(r).position==="static";)r=Gt(r);return r&&(Ae(r)==="html"||Ae(r)==="body"&&Te(r).position==="static")?t:r||rn(e)||t}function Rt(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function et(e,t,r){return $e(e,dt(t,r))}function nn(e,t,r){var a=et(e,t,r);return a>r?r:a}function pr(){return{top:0,right:0,bottom:0,left:0}}function dr(e){return Object.assign({},pr(),e)}function vr(e,t){return t.reduce(function(r,a){return r[a]=e,r},{})}var an=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,dr(typeof t!="number"?t:vr(t,it))};function on(e){var t,r=e.state,a=e.name,i=e.options,f=r.elements.arrow,u=r.modifiersData.popperOffsets,p=xe(r.placement),l=Rt(p),h=[ae,de].indexOf(p)>=0,v=h?"height":"width";if(!(!f||!u)){var T=an(i.padding,r),C=Mt(f),g=l==="y"?ne:ae,w=l==="y"?pe:de,A=r.rects.reference[v]+r.rects.reference[l]-u[l]-r.rects.popper[v],x=u[l]-r.rects.reference[l],k=ot(f),L=k?l==="y"?k.clientHeight||0:k.clientWidth||0:0,M=A/2-x/2,o=T[g],N=L-C[v]-T[w],c=L/2-C[v]/2+M,R=et(o,c,N),W=l;r.modifiersData[a]=(t={},t[W]=R,t.centerOffset=R-c,t)}}function sn(e){var t=e.state,r=e.options,a=r.element,i=a===void 0?"[data-popper-arrow]":a;i!=null&&(typeof i=="string"&&(i=t.elements.popper.querySelector(i),!i)||fr(t.elements.popper,i)&&(t.elements.arrow=i))}const ln={name:"arrow",enabled:!0,phase:"main",fn:on,effect:sn,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ze(e){return e.split("-")[1]}var cn={top:"auto",right:"auto",bottom:"auto",left:"auto"};function un(e,t){var r=e.x,a=e.y,i=t.devicePixelRatio||1;return{x:Ke(r*i)/i||0,y:Ke(a*i)/i||0}}function qt(e){var t,r=e.popper,a=e.popperRect,i=e.placement,f=e.variation,u=e.offsets,p=e.position,l=e.gpuAcceleration,h=e.adaptive,v=e.roundOffsets,T=e.isFixed,C=u.x,g=C===void 0?0:C,w=u.y,A=w===void 0?0:w,x=typeof v=="function"?v({x:g,y:A}):{x:g,y:A};g=x.x,A=x.y;var k=u.hasOwnProperty("x"),L=u.hasOwnProperty("y"),M=ae,o=ne,N=window;if(h){var c=ot(r),R="clientHeight",W="clientWidth";if(c===oe(r)&&(c=Se(r),Te(c).position!=="static"&&p==="absolute"&&(R="scrollHeight",W="scrollWidth")),c=c,i===ne||(i===ae||i===de)&&f===nt){o=pe;var $=T&&c===N&&N.visualViewport?N.visualViewport.height:c[R];A-=$-a.height,A*=l?1:-1}if(i===ae||(i===ne||i===pe)&&f===nt){M=de;var P=T&&c===N&&N.visualViewport?N.visualViewport.width:c[W];g-=P-a.width,g*=l?1:-1}}var F=Object.assign({position:p},h&&cn),U=v===!0?un({x:g,y:A},oe(r)):{x:g,y:A};if(g=U.x,A=U.y,l){var j;return Object.assign({},F,(j={},j[o]=L?"0":"",j[M]=k?"0":"",j.transform=(N.devicePixelRatio||1)<=1?"translate("+g+"px, "+A+"px)":"translate3d("+g+"px, "+A+"px, 0)",j))}return Object.assign({},F,(t={},t[o]=L?A+"px":"",t[M]=k?g+"px":"",t.transform="",t))}function fn(e){var t=e.state,r=e.options,a=r.gpuAcceleration,i=a===void 0?!0:a,f=r.adaptive,u=f===void 0?!0:f,p=r.roundOffsets,l=p===void 0?!0:p,h={placement:xe(t.placement),variation:Ze(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,qt(Object.assign({},h,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:u,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,qt(Object.assign({},h,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const pn={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn,data:{}};var ut={passive:!0};function dn(e){var t=e.state,r=e.instance,a=e.options,i=a.scroll,f=i===void 0?!0:i,u=a.resize,p=u===void 0?!0:u,l=oe(t.elements.popper),h=[].concat(t.scrollParents.reference,t.scrollParents.popper);return f&&h.forEach(function(v){v.addEventListener("scroll",r.update,ut)}),p&&l.addEventListener("resize",r.update,ut),function(){f&&h.forEach(function(v){v.removeEventListener("scroll",r.update,ut)}),p&&l.removeEventListener("resize",r.update,ut)}}const vn={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:dn,data:{}};var mn={left:"right",right:"left",bottom:"top",top:"bottom"};function pt(e){return e.replace(/left|right|bottom|top/g,function(t){return mn[t]})}var hn={start:"end",end:"start"};function _t(e){return e.replace(/start|end/g,function(t){return hn[t]})}function Ht(e){var t=oe(e),r=t.pageXOffset,a=t.pageYOffset;return{scrollLeft:r,scrollTop:a}}function Pt(e){return Je(Se(e)).left+Ht(e).scrollLeft}function gn(e,t){var r=oe(e),a=Se(e),i=r.visualViewport,f=a.clientWidth,u=a.clientHeight,p=0,l=0;if(i){f=i.width,u=i.height;var h=ur();(h||!h&&t==="fixed")&&(p=i.offsetLeft,l=i.offsetTop)}return{width:f,height:u,x:p+Pt(e),y:l}}function yn(e){var t,r=Se(e),a=Ht(e),i=(t=e.ownerDocument)==null?void 0:t.body,f=$e(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),u=$e(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),p=-a.scrollLeft+Pt(e),l=-a.scrollTop;return Te(i||r).direction==="rtl"&&(p+=$e(r.clientWidth,i?i.clientWidth:0)-f),{width:f,height:u,x:p,y:l}}function $t(e){var t=Te(e),r=t.overflow,a=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+a)}function mr(e){return["html","body","#document"].indexOf(Ae(e))>=0?e.ownerDocument.body:fe(e)&&$t(e)?e:mr(ht(e))}function tt(e,t){var r;t===void 0&&(t=[]);var a=mr(e),i=a===((r=e.ownerDocument)==null?void 0:r.body),f=oe(a),u=i?[f].concat(f.visualViewport||[],$t(a)?a:[]):a,p=t.concat(u);return i?p:p.concat(tt(ht(u)))}function Dt(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function bn(e,t){var r=Je(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function Yt(e,t,r){return t===sr?Dt(gn(e,r)):je(t)?bn(t,r):Dt(yn(Se(e)))}function wn(e){var t=tt(ht(e)),r=["absolute","fixed"].indexOf(Te(e).position)>=0,a=r&&fe(e)?ot(e):e;return je(a)?t.filter(function(i){return je(i)&&fr(i,a)&&Ae(i)!=="body"}):[]}function En(e,t,r,a){var i=t==="clippingParents"?wn(e):[].concat(t),f=[].concat(i,[r]),u=f[0],p=f.reduce(function(l,h){var v=Yt(e,h,a);return l.top=$e(v.top,l.top),l.right=dt(v.right,l.right),l.bottom=dt(v.bottom,l.bottom),l.left=$e(v.left,l.left),l},Yt(e,u,a));return p.width=p.right-p.left,p.height=p.bottom-p.top,p.x=p.left,p.y=p.top,p}function hr(e){var t=e.reference,r=e.element,a=e.placement,i=a?xe(a):null,f=a?Ze(a):null,u=t.x+t.width/2-r.width/2,p=t.y+t.height/2-r.height/2,l;switch(i){case ne:l={x:u,y:t.y-r.height};break;case pe:l={x:u,y:t.y+t.height};break;case de:l={x:t.x+t.width,y:p};break;case ae:l={x:t.x-r.width,y:p};break;default:l={x:t.x,y:t.y}}var h=i?Rt(i):null;if(h!=null){var v=h==="y"?"height":"width";switch(f){case ze:l[h]=l[h]-(t[v]/2-r[v]/2);break;case nt:l[h]=l[h]+(t[v]/2-r[v]/2);break}}return l}function at(e,t){t===void 0&&(t={});var r=t,a=r.placement,i=a===void 0?e.placement:a,f=r.strategy,u=f===void 0?e.strategy:f,p=r.boundary,l=p===void 0?Ur:p,h=r.rootBoundary,v=h===void 0?sr:h,T=r.elementContext,C=T===void 0?Qe:T,g=r.altBoundary,w=g===void 0?!1:g,A=r.padding,x=A===void 0?0:A,k=dr(typeof x!="number"?x:vr(x,it)),L=C===Qe?Vr:Qe,M=e.rects.popper,o=e.elements[w?L:C],N=En(je(o)?o:o.contextElement||Se(e.elements.popper),l,v,u),c=Je(e.elements.reference),R=hr({reference:c,element:M,strategy:"absolute",placement:i}),W=Dt(Object.assign({},M,R)),$=C===Qe?W:c,P={top:N.top-$.top+k.top,bottom:$.bottom-N.bottom+k.bottom,left:N.left-$.left+k.left,right:$.right-N.right+k.right},F=e.modifiersData.offset;if(C===Qe&&F){var U=F[i];Object.keys(P).forEach(function(j){var Z=[de,pe].indexOf(j)>=0?1:-1,z=[ne,pe].indexOf(j)>=0?"y":"x";P[j]+=U[z]*Z})}return P}function xn(e,t){t===void 0&&(t={});var r=t,a=r.placement,i=r.boundary,f=r.rootBoundary,u=r.padding,p=r.flipVariations,l=r.allowedAutoPlacements,h=l===void 0?lr:l,v=Ze(a),T=v?p?Wt:Wt.filter(function(w){return Ze(w)===v}):it,C=T.filter(function(w){return h.indexOf(w)>=0});C.length===0&&(C=T);var g=C.reduce(function(w,A){return w[A]=at(e,{placement:A,boundary:i,rootBoundary:f,padding:u})[xe(A)],w},{});return Object.keys(g).sort(function(w,A){return g[w]-g[A]})}function An(e){if(xe(e)===It)return[];var t=pt(e);return[_t(e),t,_t(t)]}function Tn(e){var t=e.state,r=e.options,a=e.name;if(!t.modifiersData[a]._skip){for(var i=r.mainAxis,f=i===void 0?!0:i,u=r.altAxis,p=u===void 0?!0:u,l=r.fallbackPlacements,h=r.padding,v=r.boundary,T=r.rootBoundary,C=r.altBoundary,g=r.flipVariations,w=g===void 0?!0:g,A=r.allowedAutoPlacements,x=t.options.placement,k=xe(x),L=k===x,M=l||(L||!w?[pt(x)]:An(x)),o=[x].concat(M).reduce(function(se,ie){return se.concat(xe(ie)===It?xn(t,{placement:ie,boundary:v,rootBoundary:T,padding:h,flipVariations:w,allowedAutoPlacements:A}):ie)},[]),N=t.rects.reference,c=t.rects.popper,R=new Map,W=!0,$=o[0],P=0;P<o.length;P++){var F=o[P],U=xe(F),j=Ze(F)===ze,Z=[ne,pe].indexOf(U)>=0,z=Z?"width":"height",Y=at(t,{placement:F,boundary:v,rootBoundary:T,altBoundary:C,padding:h}),q=Z?j?de:ae:j?pe:ne;N[z]>c[z]&&(q=pt(q));var _=pt(q),K=[];if(f&&K.push(Y[U]<=0),p&&K.push(Y[q]<=0,Y[_]<=0),K.every(function(se){return se})){$=F,W=!1;break}R.set(F,K)}if(W)for(var Q=w?3:1,ve=function(ie){var J=o.find(function(Oe){var le=R.get(Oe);if(le)return le.slice(0,ie).every(function(me){return me})});if(J)return $=J,"break"},X=Q;X>0;X--){var be=ve(X);if(be==="break")break}t.placement!==$&&(t.modifiersData[a]._skip=!0,t.placement=$,t.reset=!0)}}const On={name:"flip",enabled:!0,phase:"main",fn:Tn,requiresIfExists:["offset"],data:{_skip:!1}};function Xt(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function zt(e){return[ne,de,pe,ae].some(function(t){return e[t]>=0})}function Cn(e){var t=e.state,r=e.name,a=t.rects.reference,i=t.rects.popper,f=t.modifiersData.preventOverflow,u=at(t,{elementContext:"reference"}),p=at(t,{altBoundary:!0}),l=Xt(u,a),h=Xt(p,i,f),v=zt(l),T=zt(h);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:h,isReferenceHidden:v,hasPopperEscaped:T},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":v,"data-popper-escaped":T})}const Ln={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Cn};function kn(e,t,r){var a=xe(e),i=[ae,ne].indexOf(a)>=0?-1:1,f=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,u=f[0],p=f[1];return u=u||0,p=(p||0)*i,[ae,de].indexOf(a)>=0?{x:p,y:u}:{x:u,y:p}}function Dn(e){var t=e.state,r=e.options,a=e.name,i=r.offset,f=i===void 0?[0,0]:i,u=lr.reduce(function(v,T){return v[T]=kn(T,t.rects,f),v},{}),p=u[t.placement],l=p.x,h=p.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=h),t.modifiersData[a]=u}const Sn={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Dn};function Bn(e){var t=e.state,r=e.name;t.modifiersData[r]=hr({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const In={name:"popperOffsets",enabled:!0,phase:"read",fn:Bn,data:{}};function Nn(e){return e==="x"?"y":"x"}function Mn(e){var t=e.state,r=e.options,a=e.name,i=r.mainAxis,f=i===void 0?!0:i,u=r.altAxis,p=u===void 0?!1:u,l=r.boundary,h=r.rootBoundary,v=r.altBoundary,T=r.padding,C=r.tether,g=C===void 0?!0:C,w=r.tetherOffset,A=w===void 0?0:w,x=at(t,{boundary:l,rootBoundary:h,padding:T,altBoundary:v}),k=xe(t.placement),L=Ze(t.placement),M=!L,o=Rt(k),N=Nn(o),c=t.modifiersData.popperOffsets,R=t.rects.reference,W=t.rects.popper,$=typeof A=="function"?A(Object.assign({},t.rects,{placement:t.placement})):A,P=typeof $=="number"?{mainAxis:$,altAxis:$}:Object.assign({mainAxis:0,altAxis:0},$),F=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,U={x:0,y:0};if(c){if(f){var j,Z=o==="y"?ne:ae,z=o==="y"?pe:de,Y=o==="y"?"height":"width",q=c[o],_=q+x[Z],K=q-x[z],Q=g?-W[Y]/2:0,ve=L===ze?R[Y]:W[Y],X=L===ze?-W[Y]:-R[Y],be=t.elements.arrow,se=g&&be?Mt(be):{width:0,height:0},ie=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:pr(),J=ie[Z],Oe=ie[z],le=et(0,R[Y],se[Y]),me=M?R[Y]/2-Q-le-J-P.mainAxis:ve-le-J-P.mainAxis,we=M?-R[Y]/2+Q+le+Oe+P.mainAxis:X+le+Oe+P.mainAxis,Ce=t.elements.arrow&&ot(t.elements.arrow),Fe=Ce?o==="y"?Ce.clientTop||0:Ce.clientLeft||0:0,Be=(j=F?.[o])!=null?j:0,Ue=q+me-Be-Fe,Ve=q+we-Be,Ie=et(g?dt(_,Ue):_,q,g?$e(K,Ve):K);c[o]=Ie,U[o]=Ie-q}if(p){var Ne,We=o==="x"?ne:ae,Ge=o==="x"?pe:de,ce=c[N],G=N==="y"?"height":"width",H=ce+x[We],he=ce-x[Ge],Me=[ne,ae].indexOf(k)!==-1,Le=(Ne=F?.[N])!=null?Ne:0,n=Me?H:ce-R[G]-W[G]-Le+P.altAxis,d=Me?ce+R[G]+W[G]-Le-P.altAxis:he,m=g&&Me?nn(n,ce,d):et(g?n:H,ce,g?d:he);c[N]=m,U[N]=m-ce}t.modifiersData[a]=U}}const Rn={name:"preventOverflow",enabled:!0,phase:"main",fn:Mn,requiresIfExists:["offset"]};function Hn(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Pn(e){return e===oe(e)||!fe(e)?Ht(e):Hn(e)}function $n(e){var t=e.getBoundingClientRect(),r=Ke(t.width)/e.offsetWidth||1,a=Ke(t.height)/e.offsetHeight||1;return r!==1||a!==1}function jn(e,t,r){r===void 0&&(r=!1);var a=fe(t),i=fe(t)&&$n(t),f=Se(t),u=Je(e,i,r),p={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(a||!a&&!r)&&((Ae(t)!=="body"||$t(f))&&(p=Pn(t)),fe(t)?(l=Je(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):f&&(l.x=Pt(f))),{x:u.left+p.scrollLeft-l.x,y:u.top+p.scrollTop-l.y,width:u.width,height:u.height}}function Fn(e){var t=new Map,r=new Set,a=[];e.forEach(function(f){t.set(f.name,f)});function i(f){r.add(f.name);var u=[].concat(f.requires||[],f.requiresIfExists||[]);u.forEach(function(p){if(!r.has(p)){var l=t.get(p);l&&i(l)}}),a.push(f)}return e.forEach(function(f){r.has(f.name)||i(f)}),a}function Un(e){var t=Fn(e);return Zr.reduce(function(r,a){return r.concat(t.filter(function(i){return i.phase===a}))},[])}function Vn(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function Wn(e){var t=e.reduce(function(r,a){var i=r[a.name];return r[a.name]=i?Object.assign({},i,a,{options:Object.assign({},i.options,a.options),data:Object.assign({},i.data,a.data)}):a,r},{});return Object.keys(t).map(function(r){return t[r]})}var Kt={placement:"bottom",modifiers:[],strategy:"absolute"};function Jt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function Gn(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,a=r===void 0?[]:r,i=t.defaultOptions,f=i===void 0?Kt:i;return function(p,l,h){h===void 0&&(h=f);var v={placement:"bottom",orderedModifiers:[],options:Object.assign({},Kt,f),modifiersData:{},elements:{reference:p,popper:l},attributes:{},styles:{}},T=[],C=!1,g={state:v,setOptions:function(k){var L=typeof k=="function"?k(v.options):k;A(),v.options=Object.assign({},f,v.options,L),v.scrollParents={reference:je(p)?tt(p):p.contextElement?tt(p.contextElement):[],popper:tt(l)};var M=Un(Wn([].concat(a,v.options.modifiers)));return v.orderedModifiers=M.filter(function(o){return o.enabled}),w(),g.update()},forceUpdate:function(){if(!C){var k=v.elements,L=k.reference,M=k.popper;if(Jt(L,M)){v.rects={reference:jn(L,ot(M),v.options.strategy==="fixed"),popper:Mt(M)},v.reset=!1,v.placement=v.options.placement,v.orderedModifiers.forEach(function(P){return v.modifiersData[P.name]=Object.assign({},P.data)});for(var o=0;o<v.orderedModifiers.length;o++){if(v.reset===!0){v.reset=!1,o=-1;continue}var N=v.orderedModifiers[o],c=N.fn,R=N.options,W=R===void 0?{}:R,$=N.name;typeof c=="function"&&(v=c({state:v,options:W,name:$,instance:g})||v)}}}},update:Vn(function(){return new Promise(function(x){g.forceUpdate(),x(v)})}),destroy:function(){A(),C=!0}};if(!Jt(p,l))return g;g.setOptions(h).then(function(x){!C&&h.onFirstUpdate&&h.onFirstUpdate(x)});function w(){v.orderedModifiers.forEach(function(x){var k=x.name,L=x.options,M=L===void 0?{}:L,o=x.effect;if(typeof o=="function"){var N=o({state:v,name:k,instance:g,options:M}),c=function(){};T.push(N||c)}})}function A(){T.forEach(function(x){return x()}),T=[]}return g}}var qn=[vn,In,pn,cr,Sn,On,Rn,ln,Ln],_n=Gn({defaultModifiers:qn}),Yn="tippy-box",gr="tippy-content",Xn="tippy-backdrop",yr="tippy-arrow",br="tippy-svg-arrow",He={passive:!0,capture:!0},wr=function(){return document.body};function At(e,t,r){if(Array.isArray(e)){var a=e[t];return a??(Array.isArray(r)?r[t]:r)}return e}function jt(e,t){var r={}.toString.call(e);return r.indexOf("[object")===0&&r.indexOf(t+"]")>-1}function Er(e,t){return typeof e=="function"?e.apply(void 0,t):e}function Zt(e,t){if(t===0)return e;var r;return function(a){clearTimeout(r),r=setTimeout(function(){e(a)},t)}}function zn(e){return e.split(/\s+/).filter(Boolean)}function Xe(e){return[].concat(e)}function Qt(e,t){e.indexOf(t)===-1&&e.push(t)}function Kn(e){return e.filter(function(t,r){return e.indexOf(t)===r})}function Jn(e){return e.split("-")[0]}function vt(e){return[].slice.call(e)}function er(e){return Object.keys(e).reduce(function(t,r){return e[r]!==void 0&&(t[r]=e[r]),t},{})}function rt(){return document.createElement("div")}function gt(e){return["Element","Fragment"].some(function(t){return jt(e,t)})}function Zn(e){return jt(e,"NodeList")}function Qn(e){return jt(e,"MouseEvent")}function ea(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function ta(e){return gt(e)?[e]:Zn(e)?vt(e):Array.isArray(e)?e:vt(document.querySelectorAll(e))}function Tt(e,t){e.forEach(function(r){r&&(r.style.transitionDuration=t+"ms")})}function tr(e,t){e.forEach(function(r){r&&r.setAttribute("data-state",t)})}function ra(e){var t,r=Xe(e),a=r[0];return a!=null&&(t=a.ownerDocument)!=null&&t.body?a.ownerDocument:document}function na(e,t){var r=t.clientX,a=t.clientY;return e.every(function(i){var f=i.popperRect,u=i.popperState,p=i.props,l=p.interactiveBorder,h=Jn(u.placement),v=u.modifiersData.offset;if(!v)return!0;var T=h==="bottom"?v.top.y:0,C=h==="top"?v.bottom.y:0,g=h==="right"?v.left.x:0,w=h==="left"?v.right.x:0,A=f.top-a+T>l,x=a-f.bottom-C>l,k=f.left-r+g>l,L=r-f.right-w>l;return A||x||k||L})}function Ot(e,t,r){var a=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){e[a](i,r)})}function rr(e,t){for(var r=t;r;){var a;if(e.contains(r))return!0;r=r.getRootNode==null||(a=r.getRootNode())==null?void 0:a.host}return!1}var Ee={isTouch:!1},nr=0;function aa(){Ee.isTouch||(Ee.isTouch=!0,window.performance&&document.addEventListener("mousemove",xr))}function xr(){var e=performance.now();e-nr<20&&(Ee.isTouch=!1,document.removeEventListener("mousemove",xr)),nr=e}function ia(){var e=document.activeElement;if(ea(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function oa(){document.addEventListener("touchstart",aa,He),window.addEventListener("blur",ia)}var sa=typeof window<"u"&&typeof document<"u",la=sa?!!window.msCrypto:!1,ca={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},ua={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},ge=Object.assign({appendTo:wr,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},ca,ua),fa=Object.keys(ge),pa=function(t){var r=Object.keys(t);r.forEach(function(a){ge[a]=t[a]})};function Ar(e){var t=e.plugins||[],r=t.reduce(function(a,i){var f=i.name,u=i.defaultValue;if(f){var p;a[f]=e[f]!==void 0?e[f]:(p=ge[f])!=null?p:u}return a},{});return Object.assign({},e,r)}function da(e,t){var r=t?Object.keys(Ar(Object.assign({},ge,{plugins:t}))):fa,a=r.reduce(function(i,f){var u=(e.getAttribute("data-tippy-"+f)||"").trim();if(!u)return i;if(f==="content")i[f]=u;else try{i[f]=JSON.parse(u)}catch{i[f]=u}return i},{});return a}function ar(e,t){var r=Object.assign({},t,{content:Er(t.content,[e])},t.ignoreAttributes?{}:da(e,t.plugins));return r.aria=Object.assign({},ge.aria,r.aria),r.aria={expanded:r.aria.expanded==="auto"?t.interactive:r.aria.expanded,content:r.aria.content==="auto"?t.interactive?null:"describedby":r.aria.content},r}var va=function(){return"innerHTML"};function St(e,t){e[va()]=t}function ir(e){var t=rt();return e===!0?t.className=yr:(t.className=br,gt(e)?t.appendChild(e):St(t,e)),t}function or(e,t){gt(t.content)?(St(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?St(e,t.content):e.textContent=t.content)}function Bt(e){var t=e.firstElementChild,r=vt(t.children);return{box:t,content:r.find(function(a){return a.classList.contains(gr)}),arrow:r.find(function(a){return a.classList.contains(yr)||a.classList.contains(br)}),backdrop:r.find(function(a){return a.classList.contains(Xn)})}}function Tr(e){var t=rt(),r=rt();r.className=Yn,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var a=rt();a.className=gr,a.setAttribute("data-state","hidden"),or(a,e.props),t.appendChild(r),r.appendChild(a),i(e.props,e.props);function i(f,u){var p=Bt(t),l=p.box,h=p.content,v=p.arrow;u.theme?l.setAttribute("data-theme",u.theme):l.removeAttribute("data-theme"),typeof u.animation=="string"?l.setAttribute("data-animation",u.animation):l.removeAttribute("data-animation"),u.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof u.maxWidth=="number"?u.maxWidth+"px":u.maxWidth,u.role?l.setAttribute("role",u.role):l.removeAttribute("role"),(f.content!==u.content||f.allowHTML!==u.allowHTML)&&or(h,e.props),u.arrow?v?f.arrow!==u.arrow&&(l.removeChild(v),l.appendChild(ir(u.arrow))):l.appendChild(ir(u.arrow)):v&&l.removeChild(v)}return{popper:t,onUpdate:i}}Tr.$$tippy=!0;var ma=1,ft=[],Ct=[];function ha(e,t){var r=ar(e,Object.assign({},ge,Ar(er(t)))),a,i,f,u=!1,p=!1,l=!1,h=!1,v,T,C,g=[],w=Zt(Ue,r.interactiveDebounce),A,x=ma++,k=null,L=Kn(r.plugins),M={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},o={id:x,reference:e,popper:rt(),popperInstance:k,props:r,state:M,plugins:L,clearDelayTimeouts:n,setProps:d,setContent:m,show:b,hide:O,hideWithInteractivity:S,enable:Me,disable:Le,unmount:B,destroy:V};if(!r.render)return o;var N=r.render(o),c=N.popper,R=N.onUpdate;c.setAttribute("data-tippy-root",""),c.id="tippy-"+o.id,o.popper=c,e._tippy=o,c._tippy=o;var W=L.map(function(s){return s.fn(o)}),$=e.hasAttribute("aria-expanded");return Ce(),Q(),q(),_("onCreate",[o]),r.showOnCreate&&H(),c.addEventListener("mouseenter",function(){o.props.interactive&&o.state.isVisible&&o.clearDelayTimeouts()}),c.addEventListener("mouseleave",function(){o.props.interactive&&o.props.trigger.indexOf("mouseenter")>=0&&Z().addEventListener("mousemove",w)}),o;function P(){var s=o.props.touch;return Array.isArray(s)?s:[s,0]}function F(){return P()[0]==="hold"}function U(){var s;return!!((s=o.props.render)!=null&&s.$$tippy)}function j(){return A||e}function Z(){var s=j().parentNode;return s?ra(s):document}function z(){return Bt(c)}function Y(s){return o.state.isMounted&&!o.state.isVisible||Ee.isTouch||v&&v.type==="focus"?0:At(o.props.delay,s?0:1,ge.delay)}function q(s){s===void 0&&(s=!1),c.style.pointerEvents=o.props.interactive&&!s?"":"none",c.style.zIndex=""+o.props.zIndex}function _(s,y,E){if(E===void 0&&(E=!0),W.forEach(function(I){I[s]&&I[s].apply(I,y)}),E){var D;(D=o.props)[s].apply(D,y)}}function K(){var s=o.props.aria;if(s.content){var y="aria-"+s.content,E=c.id,D=Xe(o.props.triggerTarget||e);D.forEach(function(I){var te=I.getAttribute(y);if(o.state.isVisible)I.setAttribute(y,te?te+" "+E:E);else{var ue=te&&te.replace(E,"").trim();ue?I.setAttribute(y,ue):I.removeAttribute(y)}})}}function Q(){if(!($||!o.props.aria.expanded)){var s=Xe(o.props.triggerTarget||e);s.forEach(function(y){o.props.interactive?y.setAttribute("aria-expanded",o.state.isVisible&&y===j()?"true":"false"):y.removeAttribute("aria-expanded")})}}function ve(){Z().removeEventListener("mousemove",w),ft=ft.filter(function(s){return s!==w})}function X(s){if(!(Ee.isTouch&&(l||s.type==="mousedown"))){var y=s.composedPath&&s.composedPath()[0]||s.target;if(!(o.props.interactive&&rr(c,y))){if(Xe(o.props.triggerTarget||e).some(function(E){return rr(E,y)})){if(Ee.isTouch||o.state.isVisible&&o.props.trigger.indexOf("click")>=0)return}else _("onClickOutside",[o,s]);o.props.hideOnClick===!0&&(o.clearDelayTimeouts(),o.hide(),p=!0,setTimeout(function(){p=!1}),o.state.isMounted||J())}}}function be(){l=!0}function se(){l=!1}function ie(){var s=Z();s.addEventListener("mousedown",X,!0),s.addEventListener("touchend",X,He),s.addEventListener("touchstart",se,He),s.addEventListener("touchmove",be,He)}function J(){var s=Z();s.removeEventListener("mousedown",X,!0),s.removeEventListener("touchend",X,He),s.removeEventListener("touchstart",se,He),s.removeEventListener("touchmove",be,He)}function Oe(s,y){me(s,function(){!o.state.isVisible&&c.parentNode&&c.parentNode.contains(c)&&y()})}function le(s,y){me(s,y)}function me(s,y){var E=z().box;function D(I){I.target===E&&(Ot(E,"remove",D),y())}if(s===0)return y();Ot(E,"remove",T),Ot(E,"add",D),T=D}function we(s,y,E){E===void 0&&(E=!1);var D=Xe(o.props.triggerTarget||e);D.forEach(function(I){I.addEventListener(s,y,E),g.push({node:I,eventType:s,handler:y,options:E})})}function Ce(){F()&&(we("touchstart",Be,{passive:!0}),we("touchend",Ve,{passive:!0})),zn(o.props.trigger).forEach(function(s){if(s!=="manual")switch(we(s,Be),s){case"mouseenter":we("mouseleave",Ve);break;case"focus":we(la?"focusout":"blur",Ie);break;case"focusin":we("focusout",Ie);break}})}function Fe(){g.forEach(function(s){var y=s.node,E=s.eventType,D=s.handler,I=s.options;y.removeEventListener(E,D,I)}),g=[]}function Be(s){var y,E=!1;if(!(!o.state.isEnabled||Ne(s)||p)){var D=((y=v)==null?void 0:y.type)==="focus";v=s,A=s.currentTarget,Q(),!o.state.isVisible&&Qn(s)&&ft.forEach(function(I){return I(s)}),s.type==="click"&&(o.props.trigger.indexOf("mouseenter")<0||u)&&o.props.hideOnClick!==!1&&o.state.isVisible?E=!0:H(s),s.type==="click"&&(u=!E),E&&!D&&he(s)}}function Ue(s){var y=s.target,E=j().contains(y)||c.contains(y);if(!(s.type==="mousemove"&&E)){var D=G().concat(c).map(function(I){var te,ue=I._tippy,qe=(te=ue.popperInstance)==null?void 0:te.state;return qe?{popperRect:I.getBoundingClientRect(),popperState:qe,props:r}:null}).filter(Boolean);na(D,s)&&(ve(),he(s))}}function Ve(s){var y=Ne(s)||o.props.trigger.indexOf("click")>=0&&u;if(!y){if(o.props.interactive){o.hideWithInteractivity(s);return}he(s)}}function Ie(s){o.props.trigger.indexOf("focusin")<0&&s.target!==j()||o.props.interactive&&s.relatedTarget&&c.contains(s.relatedTarget)||he(s)}function Ne(s){return Ee.isTouch?F()!==s.type.indexOf("touch")>=0:!1}function We(){Ge();var s=o.props,y=s.popperOptions,E=s.placement,D=s.offset,I=s.getReferenceClientRect,te=s.moveTransition,ue=U()?Bt(c).arrow:null,qe=I?{getBoundingClientRect:I,contextElement:I.contextElement||j()}:e,Ut={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(lt){var _e=lt.state;if(U()){var Dr=z(),xt=Dr.box;["placement","reference-hidden","escaped"].forEach(function(ct){ct==="placement"?xt.setAttribute("data-placement",_e.placement):_e.attributes.popper["data-popper-"+ct]?xt.setAttribute("data-"+ct,""):xt.removeAttribute("data-"+ct)}),_e.attributes.popper={}}}},Re=[{name:"offset",options:{offset:D}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!te}},Ut];U()&&ue&&Re.push({name:"arrow",options:{element:ue,padding:3}}),Re.push.apply(Re,y?.modifiers||[]),o.popperInstance=_n(qe,c,Object.assign({},y,{placement:E,onFirstUpdate:C,modifiers:Re}))}function Ge(){o.popperInstance&&(o.popperInstance.destroy(),o.popperInstance=null)}function ce(){var s=o.props.appendTo,y,E=j();o.props.interactive&&s===wr||s==="parent"?y=E.parentNode:y=Er(s,[E]),y.contains(c)||y.appendChild(c),o.state.isMounted=!0,We()}function G(){return vt(c.querySelectorAll("[data-tippy-root]"))}function H(s){o.clearDelayTimeouts(),s&&_("onTrigger",[o,s]),ie();var y=Y(!0),E=P(),D=E[0],I=E[1];Ee.isTouch&&D==="hold"&&I&&(y=I),y?a=setTimeout(function(){o.show()},y):o.show()}function he(s){if(o.clearDelayTimeouts(),_("onUntrigger",[o,s]),!o.state.isVisible){J();return}if(!(o.props.trigger.indexOf("mouseenter")>=0&&o.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(s.type)>=0&&u)){var y=Y(!1);y?i=setTimeout(function(){o.state.isVisible&&o.hide()},y):f=requestAnimationFrame(function(){o.hide()})}}function Me(){o.state.isEnabled=!0}function Le(){o.hide(),o.state.isEnabled=!1}function n(){clearTimeout(a),clearTimeout(i),cancelAnimationFrame(f)}function d(s){if(!o.state.isDestroyed){_("onBeforeUpdate",[o,s]),Fe();var y=o.props,E=ar(e,Object.assign({},y,er(s),{ignoreAttributes:!0}));o.props=E,Ce(),y.interactiveDebounce!==E.interactiveDebounce&&(ve(),w=Zt(Ue,E.interactiveDebounce)),y.triggerTarget&&!E.triggerTarget?Xe(y.triggerTarget).forEach(function(D){D.removeAttribute("aria-expanded")}):E.triggerTarget&&e.removeAttribute("aria-expanded"),Q(),q(),R&&R(y,E),o.popperInstance&&(We(),G().forEach(function(D){requestAnimationFrame(D._tippy.popperInstance.forceUpdate)})),_("onAfterUpdate",[o,s])}}function m(s){o.setProps({content:s})}function b(){var s=o.state.isVisible,y=o.state.isDestroyed,E=!o.state.isEnabled,D=Ee.isTouch&&!o.props.touch,I=At(o.props.duration,0,ge.duration);if(!(s||y||E||D)&&!j().hasAttribute("disabled")&&(_("onShow",[o],!1),o.props.onShow(o)!==!1)){if(o.state.isVisible=!0,U()&&(c.style.visibility="visible"),q(),ie(),o.state.isMounted||(c.style.transition="none"),U()){var te=z(),ue=te.box,qe=te.content;Tt([ue,qe],0)}C=function(){var Re;if(!(!o.state.isVisible||h)){if(h=!0,c.offsetHeight,c.style.transition=o.props.moveTransition,U()&&o.props.animation){var Et=z(),lt=Et.box,_e=Et.content;Tt([lt,_e],I),tr([lt,_e],"visible")}K(),Q(),Qt(Ct,o),(Re=o.popperInstance)==null||Re.forceUpdate(),_("onMount",[o]),o.props.animation&&U()&&le(I,function(){o.state.isShown=!0,_("onShown",[o])})}},ce()}}function O(){var s=!o.state.isVisible,y=o.state.isDestroyed,E=!o.state.isEnabled,D=At(o.props.duration,1,ge.duration);if(!(s||y||E)&&(_("onHide",[o],!1),o.props.onHide(o)!==!1)){if(o.state.isVisible=!1,o.state.isShown=!1,h=!1,u=!1,U()&&(c.style.visibility="hidden"),ve(),J(),q(!0),U()){var I=z(),te=I.box,ue=I.content;o.props.animation&&(Tt([te,ue],D),tr([te,ue],"hidden"))}K(),Q(),o.props.animation?U()&&Oe(D,o.unmount):o.unmount()}}function S(s){Z().addEventListener("mousemove",w),Qt(ft,w),w(s)}function B(){o.state.isVisible&&o.hide(),o.state.isMounted&&(Ge(),G().forEach(function(s){s._tippy.unmount()}),c.parentNode&&c.parentNode.removeChild(c),Ct=Ct.filter(function(s){return s!==o}),o.state.isMounted=!1,_("onHidden",[o]))}function V(){o.state.isDestroyed||(o.clearDelayTimeouts(),o.unmount(),Fe(),delete e._tippy,o.state.isDestroyed=!0,_("onDestroy",[o]))}}function st(e,t){t===void 0&&(t={});var r=ge.plugins.concat(t.plugins||[]);oa();var a=Object.assign({},t,{plugins:r}),i=ta(e),f=i.reduce(function(u,p){var l=p&&ha(p,a);return l&&u.push(l),u},[]);return gt(e)?f[0]:f}st.defaultProps=ge;st.setDefaultProps=pa;st.currentInput=Ee;Object.assign({},cr,{effect:function(t){var r=t.state,a={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(r.elements.popper.style,a.popper),r.styles=a,r.elements.arrow&&Object.assign(r.elements.arrow.style,a.arrow)}});st.setDefaultProps({render:Tr});function ga(e,t){const r=document.getElementById(`${e}`);r&&st(r,{content:t,theme:"battlesystem"})}function ya(){const e=new Map;e.set("tip_opacity","Change the opacity of the background of a label."),e.set("tip_textsize","Change the text size of the label name."),e.set("tip_stroke","Change the player-indication color stroke around the label."),e.set("exportButton","Export your current label set to a JSON file, for sharing or saving."),e.set("importButton","Import a JSON text file and overwrite your current Label set."),e.set("saveButton","Save changes to your Labels so they are available to be used."),e.set("addButton","Add another label row to the list for a new item."),e.set("resetButton","Reset your labels back to the default state."),e.forEach((t,r)=>{ga(r,t)})}var ye=function(){/*!
* Copyright (c) 2021-2023 Momo Bassit.
* Licensed under the MIT License (MIT)
* https://github.com/mdbassit/Coloris
* Version: 0.19.0
* NPM: https://github.com/melloware/coloris-npm
*/return function(e,t,r){var a=t.createElement("canvas").getContext("2d"),i={r:0,g:0,b:0,h:0,s:0,v:0,a:1},f,u,p,l,h,v,T,C,g,w,A,x,k,L,M,o,N,c={el:"[data-coloris]",parent:"body",theme:"default",themeMode:"light",rtl:!1,wrap:!0,margin:2,format:"hex",formatToggle:!1,swatches:[],swatchesOnly:!1,alpha:!0,forceAlpha:!1,focusInput:!0,selectInput:!1,inline:!1,defaultColor:"#000000",clearButton:!1,clearLabel:"Clear",closeButton:!1,closeLabel:"Close",onChange:function(){},a11y:{open:"Open color picker",close:"Close color picker",clear:"Clear the selected color",marker:"Saturation: {s}. Brightness: {v}.",hueSlider:"Hue slider",alphaSlider:"Opacity slider",input:"Color value field",format:"Color format",swatch:"Color swatch",instruction:"Saturation and brightness selector. Use up, down, left and right arrow keys to select."}},R={},W="",$={},P=!1;function F(n){if(typeof n=="object"){var d=function(){switch(m){case"el":Y(n.el),n.wrap!==!1&&_(n.el);break;case"parent":f=t.querySelector(n.parent),f&&(f.appendChild(u),c.parent=n.parent,f===t.body&&(f=null));break;case"themeMode":c.themeMode=n.themeMode,n.themeMode==="auto"&&e.matchMedia&&e.matchMedia("(prefers-color-scheme: dark)").matches&&(c.themeMode="dark");case"theme":n.theme&&(c.theme=n.theme),u.className="clr-picker clr-"+c.theme+" clr-"+c.themeMode,c.inline&&q();break;case"rtl":c.rtl=!!n.rtl,t.querySelectorAll(".clr-field").forEach(function(D){return D.classList.toggle("clr-rtl",c.rtl)});break;case"margin":n.margin*=1,c.margin=isNaN(n.margin)?c.margin:n.margin;break;case"wrap":n.el&&n.wrap&&_(n.el);break;case"formatToggle":c.formatToggle=!!n.formatToggle,G("clr-format").style.display=c.formatToggle?"block":"none",c.formatToggle&&(c.format="auto");break;case"swatches":if(Array.isArray(n.swatches)){var O=[];n.swatches.forEach(function(D,I){O.push('<button type="button" id="clr-swatch-'+I+'" aria-labelledby="clr-swatch-label clr-swatch-'+I+'" style="color: '+D+';">'+D+"</button>")}),G("clr-swatches").innerHTML=O.length?"<div>"+O.join("")+"</div>":"",c.swatches=n.swatches.slice()}break;case"swatchesOnly":c.swatchesOnly=!!n.swatchesOnly,u.setAttribute("data-minimal",c.swatchesOnly);break;case"alpha":c.alpha=!!n.alpha,u.setAttribute("data-alpha",c.alpha);break;case"inline":if(c.inline=!!n.inline,u.setAttribute("data-inline",c.inline),c.inline){var S=n.defaultColor||c.defaultColor;M=ve(S),q(),Q(S)}break;case"clearButton":typeof n.clearButton=="object"&&(n.clearButton.label&&(c.clearLabel=n.clearButton.label,C.innerHTML=c.clearLabel),n.clearButton=n.clearButton.show),c.clearButton=!!n.clearButton,C.style.display=c.clearButton?"block":"none";break;case"clearLabel":c.clearLabel=n.clearLabel,C.innerHTML=c.clearLabel;break;case"closeButton":c.closeButton=!!n.closeButton,c.closeButton?u.insertBefore(g,v):v.appendChild(g);break;case"closeLabel":c.closeLabel=n.closeLabel,g.innerHTML=c.closeLabel;break;case"a11y":var B=n.a11y,V=!1;if(typeof B=="object")for(var s in B)B[s]&&c.a11y[s]&&(c.a11y[s]=B[s],V=!0);if(V){var y=G("clr-open-label"),E=G("clr-swatch-label");y.innerHTML=c.a11y.open,E.innerHTML=c.a11y.swatch,g.setAttribute("aria-label",c.a11y.close),C.setAttribute("aria-label",c.a11y.clear),w.setAttribute("aria-label",c.a11y.hueSlider),x.setAttribute("aria-label",c.a11y.alphaSlider),T.setAttribute("aria-label",c.a11y.input),p.setAttribute("aria-label",c.a11y.instruction)}break;default:c[m]=n[m]}};for(var m in n)d()}}function U(n,d){typeof n=="string"&&typeof d=="object"&&(R[n]=d,P=!0)}function j(n){delete R[n],Object.keys(R).length===0&&(P=!1,n===W&&z())}function Z(n){if(P){var d=["el","wrap","rtl","inline","defaultColor","a11y"],m=function(){var B=R[b];if(n.matches(b)){W=b,$={},d.forEach(function(s){return delete B[s]});for(var V in B)$[V]=Array.isArray(c[V])?c[V].slice():c[V];return F(B),"break"}};for(var b in R){var O=m();if(O==="break")break}}}function z(){Object.keys($).length>0&&(F($),W="",$={})}function Y(n){H(t,"click",n,function(d){c.inline||(Z(d.target),L=d.target,o=L.value,M=ve(o),u.classList.add("clr-open"),q(),Q(o),(c.focusInput||c.selectInput)&&T.focus({preventScroll:!0}),c.selectInput&&T.select(),(N||c.swatchesOnly)&&ce().shift().focus(),L.dispatchEvent(new Event("open",{bubbles:!0})))}),H(t,"input",n,function(d){var m=d.target.parentNode;m.classList.contains("clr-field")&&(m.style.color=d.target.value)})}function q(){if(!(!u||!L&&!c.inline)){var n=f,d=e.scrollY,m=u.offsetWidth,b=u.offsetHeight,O={left:!1,top:!1},S,B,V,s={x:0,y:0};if(n&&(S=e.getComputedStyle(n),B=parseFloat(S.marginTop),V=parseFloat(S.borderTopWidth),s=n.getBoundingClientRect(),s.y+=V+d),!c.inline){var y=L.getBoundingClientRect(),E=y.x,D=d+y.y+y.height+c.margin;n?(E-=s.x,D-=s.y,E+m>n.clientWidth&&(E+=y.width-m,O.left=!0),D+b>n.clientHeight-B&&b+c.margin<=y.top-(s.y-d)&&(D-=y.height+b+c.margin*2,O.top=!0),D+=n.scrollTop):(E+m>t.documentElement.clientWidth&&(E+=y.width-m,O.left=!0),D+b-d>t.documentElement.clientHeight&&b+c.margin<=y.top&&(D=d+y.y-b-c.margin,O.top=!0)),u.classList.toggle("clr-left",O.left),u.classList.toggle("clr-top",O.top),u.style.left=E+"px",u.style.top=D+"px",s.x+=u.offsetLeft,s.y+=u.offsetTop}l={width:p.offsetWidth,height:p.offsetHeight,x:p.offsetLeft+s.x,y:p.offsetTop+s.y}}}function _(n){t.querySelectorAll(n).forEach(function(d){var m=d.parentNode;if(!m.classList.contains("clr-field")){var b=t.createElement("div"),O="clr-field";(c.rtl||d.classList.contains("clr-rtl"))&&(O+=" clr-rtl"),b.innerHTML='<button type="button" aria-labelledby="clr-open-label"></button>',m.insertBefore(b,d),b.setAttribute("class",O),b.style.color=d.value,b.appendChild(d)}})}function K(n){if(L&&!c.inline){var d=L;n&&(L=null,o!==d.value&&(d.value=o,d.dispatchEvent(new Event("input",{bubbles:!0})))),setTimeout(function(){o!==d.value&&d.dispatchEvent(new Event("change",{bubbles:!0}))}),u.classList.remove("clr-open"),P&&z(),d.dispatchEvent(new Event("close",{bubbles:!0})),c.focusInput&&d.focus({preventScroll:!0}),L=null}}function Q(n){var d=Ve(n),m=Ue(d);se(m.s,m.v),me(d,m),w.value=m.h,u.style.color="hsl("+m.h+", 100%, 50%)",A.style.left=m.h/360*100+"%",h.style.left=l.width*m.s/100+"px",h.style.top=l.height-l.height*m.v/100+"px",x.value=m.a*100,k.style.left=m.a*100+"%"}function ve(n){var d=n.substring(0,3).toLowerCase();return d==="rgb"||d==="hsl"?d:"hex"}function X(n){n=n!==void 0?n:T.value,L&&(L.value=n,L.dispatchEvent(new Event("input",{bubbles:!0}))),c.onChange&&c.onChange.call(e,n),t.dispatchEvent(new CustomEvent("coloris:pick",{detail:{color:n}}))}function be(n,d){var m={h:w.value*1,s:n/l.width*100,v:100-d/l.height*100,a:x.value/100},b=Fe(m);se(m.s,m.v),me(b,m),X()}function se(n,d){var m=c.a11y.marker;n=n.toFixed(1)*1,d=d.toFixed(1)*1,m=m.replace("{s}",n),m=m.replace("{v}",d),h.setAttribute("aria-label",m)}function ie(n){return{pageX:n.changedTouches?n.changedTouches[0].pageX:n.pageX,pageY:n.changedTouches?n.changedTouches[0].pageY:n.pageY}}function J(n){var d=ie(n),m=d.pageX-l.x,b=d.pageY-l.y;f&&(b+=f.scrollTop),le(m,b),n.preventDefault(),n.stopPropagation()}function Oe(n,d){var m=h.style.left.replace("px","")*1+n,b=h.style.top.replace("px","")*1+d;le(m,b)}function le(n,d){n=n<0?0:n>l.width?l.width:n,d=d<0?0:d>l.height?l.height:d,h.style.left=n+"px",h.style.top=d+"px",be(n,d),h.focus()}function me(n,d){n===void 0&&(n={}),d===void 0&&(d={});var m=c.format;for(var b in n)i[b]=n[b];for(var O in d)i[O]=d[O];var S=Ie(i),B=S.substring(0,7);switch(h.style.color=B,k.parentNode.style.color=B,k.style.color=S,v.style.color=S,p.style.display="none",p.offsetHeight,p.style.display="",k.nextElementSibling.style.display="none",k.nextElementSibling.offsetHeight,k.nextElementSibling.style.display="",m==="mixed"?m=i.a===1?"hex":"rgb":m==="auto"&&(m=M),m){case"hex":T.value=S;break;case"rgb":T.value=Ne(i);break;case"hsl":T.value=We(Be(i));break}t.querySelector('.clr-format [value="'+m+'"]').checked=!0}function we(){var n=w.value*1,d=h.style.left.replace("px","")*1,m=h.style.top.replace("px","")*1;u.style.color="hsl("+n+", 100%, 50%)",A.style.left=n/360*100+"%",be(d,m)}function Ce(){var n=x.value/100;k.style.left=n*100+"%",me({a:n}),X()}function Fe(n){var d=n.s/100,m=n.v/100,b=d*m,O=n.h/60,S=b*(1-r.abs(O%2-1)),B=m-b;b=b+B,S=S+B;var V=r.floor(O)%6,s=[b,S,B,B,S,b][V],y=[S,b,b,S,B,B][V],E=[B,B,S,b,b,S][V];return{r:r.round(s*255),g:r.round(y*255),b:r.round(E*255),a:n.a}}function Be(n){var d=n.v/100,m=d*(1-n.s/100/2),b;return m>0&&m<1&&(b=r.round((d-m)/r.min(m,1-m)*100)),{h:n.h,s:b||0,l:r.round(m*100),a:n.a}}function Ue(n){var d=n.r/255,m=n.g/255,b=n.b/255,O=r.max(d,m,b),S=r.min(d,m,b),B=O-S,V=O,s=0,y=0;return B&&(O===d&&(s=(m-b)/B),O===m&&(s=2+(b-d)/B),O===b&&(s=4+(d-m)/B),O&&(y=B/O)),s=r.floor(s*60),{h:s<0?s+360:s,s:r.round(y*100),v:r.round(V*100),a:n.a}}function Ve(n){var d=/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,m,b;return a.fillStyle="#000",a.fillStyle=n,m=d.exec(a.fillStyle),m?(b={r:m[3]*1,g:m[4]*1,b:m[5]*1,a:m[6]*1},b.a=+b.a.toFixed(2)):(m=a.fillStyle.replace("#","").match(/.{2}/g).map(function(O){return parseInt(O,16)}),b={r:m[0],g:m[1],b:m[2],a:1}),b}function Ie(n){var d=n.r.toString(16),m=n.g.toString(16),b=n.b.toString(16),O="";if(n.r<16&&(d="0"+d),n.g<16&&(m="0"+m),n.b<16&&(b="0"+b),c.alpha&&(n.a<1||c.forceAlpha)){var S=n.a*255|0;O=S.toString(16),S<16&&(O="0"+O)}return"#"+d+m+b+O}function Ne(n){return!c.alpha||n.a===1&&!c.forceAlpha?"rgb("+n.r+", "+n.g+", "+n.b+")":"rgba("+n.r+", "+n.g+", "+n.b+", "+n.a+")"}function We(n){return!c.alpha||n.a===1&&!c.forceAlpha?"hsl("+n.h+", "+n.s+"%, "+n.l+"%)":"hsla("+n.h+", "+n.s+"%, "+n.l+"%, "+n.a+")"}function Ge(){t.getElementById("clr-picker")||(f=null,u=t.createElement("div"),u.setAttribute("id","clr-picker"),u.className="clr-picker",u.innerHTML='<input id="clr-color-value" name="clr-color-value" class="clr-color" type="text" value="" spellcheck="false" aria-label="'+c.a11y.input+'">'+('<div id="clr-color-area" class="clr-gradient" role="application" aria-label="'+c.a11y.instruction+'">')+'<div id="clr-color-marker" class="clr-marker" tabindex="0"></div></div><div class="clr-hue">'+('<input id="clr-hue-slider" name="clr-hue-slider" type="range" min="0" max="360" step="1" aria-label="'+c.a11y.hueSlider+'">')+'<div id="clr-hue-marker"></div></div><div class="clr-alpha">'+('<input id="clr-alpha-slider" name="clr-alpha-slider" type="range" min="0" max="100" step="1" aria-label="'+c.a11y.alphaSlider+'">')+'<div id="clr-alpha-marker"></div><span></span></div><div id="clr-format" class="clr-format"><fieldset class="clr-segmented">'+("<legend>"+c.a11y.format+"</legend>")+'<input id="clr-f1" type="radio" name="clr-format" value="hex"><label for="clr-f1">Hex</label><input id="clr-f2" type="radio" name="clr-format" value="rgb"><label for="clr-f2">RGB</label><input id="clr-f3" type="radio" name="clr-format" value="hsl"><label for="clr-f3">HSL</label><span></span></fieldset></div><div id="clr-swatches" class="clr-swatches"></div>'+('<button type="button" id="clr-clear" class="clr-clear" aria-label="'+c.a11y.clear+'">'+c.clearLabel+"</button>")+'<div id="clr-color-preview" class="clr-preview">'+('<button type="button" id="clr-close" class="clr-close" aria-label="'+c.a11y.close+'">'+c.closeLabel+"</button>")+"</div>"+('<span id="clr-open-label" hidden>'+c.a11y.open+"</span>")+('<span id="clr-swatch-label" hidden>'+c.a11y.swatch+"</span>"),t.body.appendChild(u),p=G("clr-color-area"),h=G("clr-color-marker"),C=G("clr-clear"),g=G("clr-close"),v=G("clr-color-preview"),T=G("clr-color-value"),w=G("clr-hue-slider"),A=G("clr-hue-marker"),x=G("clr-alpha-slider"),k=G("clr-alpha-marker"),Y(c.el),_(c.el),H(u,"mousedown",function(n){u.classList.remove("clr-keyboard-nav"),n.stopPropagation()}),H(p,"mousedown",function(n){H(t,"mousemove",J)}),H(p,"touchstart",function(n){t.addEventListener("touchmove",J,{passive:!1})}),H(h,"mousedown",function(n){H(t,"mousemove",J)}),H(h,"touchstart",function(n){t.addEventListener("touchmove",J,{passive:!1})}),H(T,"change",function(n){(L||c.inline)&&(Q(T.value),X())}),H(C,"click",function(n){X(""),K()}),H(g,"click",function(n){X(),K()}),H(t,"click",".clr-format input",function(n){M=n.target.value,me(),X()}),H(u,"click",".clr-swatches button",function(n){Q(n.target.textContent),X(),c.swatchesOnly&&K()}),H(t,"mouseup",function(n){t.removeEventListener("mousemove",J)}),H(t,"touchend",function(n){t.removeEventListener("touchmove",J)}),H(t,"mousedown",function(n){N=!1,u.classList.remove("clr-keyboard-nav"),K()}),H(t,"keydown",function(n){var d=n.key,m=n.target,b=n.shiftKey,O=["Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"];if(d==="Escape"?K(!0):O.includes(d)&&(N=!0,u.classList.add("clr-keyboard-nav")),d==="Tab"&&m.matches(".clr-picker *")){var S=ce(),B=S.shift(),V=S.pop();b&&m===B?(V.focus(),n.preventDefault()):!b&&m===V&&(B.focus(),n.preventDefault())}}),H(t,"click",".clr-field button",function(n){P&&z(),n.target.nextElementSibling.dispatchEvent(new Event("click",{bubbles:!0}))}),H(h,"keydown",function(n){var d={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};Object.keys(d).includes(n.key)&&(Oe.apply(void 0,d[n.key]),n.preventDefault())}),H(p,"click",J),H(w,"input",we),H(x,"input",Ce))}function ce(){var n=Array.from(u.querySelectorAll("input, button")),d=n.filter(function(m){return!!m.offsetWidth});return d}function G(n){return t.getElementById(n)}function H(n,d,m,b){var O=Element.prototype.matches||Element.prototype.msMatchesSelector;typeof m=="string"?n.addEventListener(d,function(S){O.call(S.target,m)&&b.call(S.target,S)}):(b=m,n.addEventListener(d,b))}function he(n,d){d=d!==void 0?d:[],t.readyState!=="loading"?n.apply(void 0,d):t.addEventListener("DOMContentLoaded",function(){n.apply(void 0,d)})}NodeList!==void 0&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);function Me(n,d){L=d,o=L.value,Z(d),M=ve(n),q(),Q(n),X(),o!==n&&L.dispatchEvent(new Event("change",{bubbles:!0}))}var Le=function(){var n={init:Ge,set:F,wrap:_,close:K,setInstance:U,setColor:Me,removeInstance:j,updatePosition:q};function d(O){he(function(){O&&(typeof O=="string"?Y(O):F(O))})}var m=function(S){d[S]=function(){for(var B=arguments.length,V=new Array(B),s=0;s<B;s++)V[s]=arguments[s];he(n[S],V)}};for(var b in n)m(b);return he(function(){e.addEventListener("resize",function(O){d.updatePosition()}),e.addEventListener("scroll",function(O){d.updatePosition()})}),d}();return Le.coloris=Le,Le}(window,document,Math)}();ye.coloris;ye.init;ye.set;ye.wrap;ye.close;ye.setInstance;ye.removeInstance;ye.updatePosition;ye.init();ye.coloris({el:".coloris",alpha:!1,format:"hex",wrap:!0,theme:"polaroid",themeMode:"light",swatches:["red","yellow","green","cyan","blue","purple"],onChange:e=>{console.log(e)}});ye.close();const Or=document.getElementById("loadingApp"),ba=document.getElementById("labelApp"),Cr=document.getElementById("label-list"),wa=document.getElementById("labelSort");let Lt=!0;const Ye=document.getElementById("mainButtons"),yt=document.getElementById("gr1n"),bt=document.getElementById("gr2n"),wt=document.getElementById("gr3n"),ke=document.getElementById("distance"),De=document.getElementById("opacity"),Pe=document.getElementById("stroke");re.onReady(async()=>{jr();const e=await re.theme.getTheme();Vt(e,document),re.theme.onChange(r=>{Vt(r,document)}),await re.player.getRole()==="GM"?(await Ir(),document.getElementById("patreonContainer").appendChild(Nr()),await La(),Fr(),ya()):(Or.innerHTML='<div class="player-view">Configuration is GM-Access only.</div>',await re.action.setHeight(70),await re.action.setWidth(150))});function mt(e){const t=Cr.insertRow(0);t.className="data-row",t.id=Mr();const r=t.insertCell(0),a=t.insertCell(1);a.id="name_"+t.id,a.setAttribute("contenteditable","true"),a.innerHTML=e?e.Name:"Default Name";const i=t.insertCell(2);i.className="center";const f=Aa();f.value=e?e.Group:"#1",f.id="group_"+t.id,i.appendChild(f);const u=t.insertCell(3);u.className="center";const p=xa();p.value=e?e.Direction:"Top",p.id="selector_"+t.id,u.appendChild(p);const l=t.insertCell(4);l.id=t.id,l.className="center",r.innerHTML=`<input id="checkbox_${t.id}" type="checkbox" ${e?.Active===0?"":"checked"}/>`;const h=e?Rr(e.Color):void 0;l.appendChild(Ea(l.id,h))}function Ea(e,t){const r=document.createElement("div"),a=document.createElement("button");a.setAttribute("aria-labelledby","clr-open-label"),a.id="clr-button_"+e,r.className="clr-field",r.id="clr-field_"+e,r.style.color=t?"rgb"+t:"rgb(0, 0, 0)",r.appendChild(a);const i=document.createElement("input");return i.type="text",i.id="clr-input_"+e,i.style.width="20px",i.className="coloris",i.setAttribute("data-coloris",""),r.appendChild(i),r}function xa(){const e=document.createElement("select");return["Top","Bottom","Left","Right"].forEach(r=>{const a=document.createElement("option");a.setAttribute("value",r);const i=document.createTextNode(r);a.appendChild(i),e.appendChild(a)}),e}function Aa(){const e=document.createElement("select");return["#1","#2","#3"].forEach(r=>{const a=document.createElement("option");a.setAttribute("value",r);const i=document.createTextNode(r);a.appendChild(i),e.appendChild(a)}),e}async function Ta(){const e=Lr();var t=document.createElement("a"),r=new Blob([JSON.stringify(e)],{type:"text/plain"});t.href=URL.createObjectURL(r),t.download=`MarkedExport-${Date.now()}`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}async function Oa(e){if(e&&e.Labels?.length>0){const t=document.getElementById("label-list");t.innerHTML="",e.Labels.forEach(r=>{mt(r)}),e.Groups.forEach(r=>{switch(r.Num){case"#1":yt.value=r.Name;break;case"#2":bt.value=r.Name;break;case"#3":wt.value=r.Name;break;default:throw new Error("Invalid Group")}}),ke.value=e.Distance,De.value=e.Opacity}await Ft()}async function Ft(){const e=Lr();let t={};t[`${ee.EXTENSIONID}/metadata_marks`]={saveData:e},await re.room.setMetadata(t)}function Lr(){const e=[],t=[],r=ke.value,a=De.value,i=Pe.value;for(var f=document.getElementById("label-list"),u=0,p;p=f.rows[u];u++){const l=p.id,h=p.querySelector("#checkbox_"+l),v=p.querySelector("#name_"+l),T=p.querySelector("#selector_"+l),C=p.querySelector("#group_"+l),g=p.querySelector("#clr-field_"+l),w=Hr(g.style.color),A={Id:l,Active:h.checked?1:0,Name:v.innerText.trim(),Direction:T.value,Color:w,Group:C.value};e.push(A)}return t.push({Name:yt.value,Num:"#1"}),t.push({Name:bt.value,Num:"#2"}),t.push({Name:wt.value,Num:"#3"}),{Groups:t,Labels:e.reverse(),Distance:r,Opacity:a,Stroke:i}}async function Ca(){confirm("Erase everything and go back to default labels?")&&(Cr.innerHTML="",await kr())}async function kr(){yt.value=ee.DEFAULTGROUP[0],bt.value=ee.DEFAULTGROUP[1],wt.value=ee.DEFAULTGROUP[2],ke.value=ee.DEFAULTFONTSIZE,De.value=ee.DEFAULTOPACITY,Pe.value=ee.DEFAULTSTROKE,ee.DEFAULTSET.forEach(e=>{mt(e)}),await Ft()}async function La(){const r=(await re.room.getMetadata())[`${ee.EXTENSIONID}/metadata_marks`]?.saveData;r&&r.Labels?.length>0?(r.Labels.forEach(g=>{mt(g)}),r.Groups.forEach(g=>{switch(g.Num){case"#1":yt.value=g.Name;break;case"#2":bt.value=g.Name;break;case"#3":wt.value=g.Name;break;default:throw new Error("Invalid Group")}})):await kr(),ke.max="999",ke.min="1",ke.maxLength=4,ke.value=r?.Distance?r.Distance:ee.DEFAULTFONTSIZE,ke.oninput=g=>{v(g.target)},De.max="99",De.min="1",De.maxLength=2,De.value=r?.Opacity?r.Opacity:ee.DEFAULTOPACITY,De.oninput=g=>{v(g.target)},Pe.max="20",Pe.min="0",Pe.maxLength=2,Pe.value=r?.Stroke?r.Stroke:ee.DEFAULTSTROKE,Pe.oninput=g=>{v(g.target)};const a=document.createElement("input");a.type="image",a.className="Icon clickable",a.id="exportButton",a.onclick=async function(){await Ta()},a.src="/export.svg",a.title="Export Data",a.height=20,a.width=20,Ye.appendChild(a);const i=document.createElement("input");i.type="image",i.className="Icon clickable",i.id="importButton",i.onclick=async function(){document.getElementById("fileButton").click()},i.src="/import.svg",i.title="Import Data",i.height=20,i.width=20,Ye.appendChild(i);const f=document.createElement("input");f.type="file",f.id="fileButton",f.title="Choose a file to import",f.className="tinyType",f.hidden=!0,f.onchange=async function(){if(console.log("FILE ADDED"),f.files&&f.files.length>0){let g=f.files[0],w=new FileReader;w.readAsText(g),w.onload=async function(){try{const A=JSON.parse(w.result);await Oa(A),re.notification.show("Import Complete!","SUCCESS")}catch(A){re.notification.show(`The import failed - ${A}`,"ERROR")}},w.onerror=function(){console.log(w.error)}}},Ye.appendChild(f);const u=document.createElement("input");u.type="image",u.className="Icon clickable",u.id="saveButton",u.onclick=async function(){await Ft()},u.src="/save.svg",u.title="Save Changes",u.height=20,u.width=20,Ye.appendChild(u);const p=document.createElement("input");p.type="image",p.className="Icon clickable",p.id="addButton",p.onclick=async function(){await mt()},p.src="/add.svg",p.title="Add Label",p.height=20,p.width=20,Ye.appendChild(p);const l=document.createElement("input");l.type="image",l.className="Icon clickable",l.id="resetButton",l.onclick=async function(){await Ca()},l.src="/reset.svg",l.title="Reset to Default Labels",l.height=20,l.width=20,Ye.appendChild(l),wa.onclick=async function(){var g,w,A,x,k,L,M;for(g=document.getElementById("label-list"),A=!0;A;){for(A=!1,w=g.getElementsByClassName("data-row"),x=0;x<w.length-1;x++)if(M=!1,k=w[x].getElementsByTagName("td")[1],L=w[x+1].getElementsByTagName("td")[1],Lt){if(k.innerHTML.toLowerCase()>L.innerHTML.toLowerCase()){M=!0;break}}else if(k.innerHTML.toLowerCase()<L.innerHTML.toLowerCase()){M=!0;break}M&&(w[x].parentNode.insertBefore(w[x+1],w[x]),A=!0)}Lt=!Lt},Or.style.display="none",ba.style.display="";function h(g){return parseInt(g)}function v(g){let w=g.min,A=g.max,x=h(g.value);x>A?g.value=A:x<w&&(g.value=w)}function T(g){g.preventDefault();const w=g.target.closest("tr");w&&w.rowIndex>0&&window.confirm(`Are you sure you want to delete ${w.children[1].innerHTML}?`)&&w.remove()}const C=document.getElementById("table-one");C&&C.addEventListener("contextmenu",T)}
