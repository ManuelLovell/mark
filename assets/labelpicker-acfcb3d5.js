import{a as O,O as d,C as w,b as S,S as x}from"./style-5d5d86f4.js";class B{static async UpdateLabel(o,l,h,b){const g=O(o.id,l.Id),E=await d.scene.items.getItems([g]),N="#242424",f=parseInt(h),T=+b/100,a=o.grid.dpi/150;let s=0;if(E.length===0){const n=await d.scene.items.getItems(c=>c.attachedTo===o.id&&c.type==="LABEL"&&c.style.pointerDirection===i(l.Direction));if(n.length>0){for(let c=0;c<n.length+1;c++)if(!n.find(e=>e.metadata[`${w.EXTENSIONID}/place`].placement===c)){s=c;break}}let p={};p[`${w.EXTENSIONID}/place`]={placement:s};const t=S().fillColor(l.Color).plainText(l.Name).strokeWidth(5).build();t.id=g,t.type="LABEL",t.attachedTo=o.id,t.visible=!!o.visible,t.locked=!0,t.position={x:o.position.x,y:o.position.y},t.metadata=p;let r,u=15,y=15;l.Direction=="Top"&&(t.position.y-=o.image.height*o.scale.y/4/a,r="DOWN",n.length>0&&s!==0&&(t.position.y-=15,t.position.y-=f*s)),l.Direction=="Bottom"&&(t.position.y+=o.image.height*o.scale.y/4/a,r="UP",n.length>0&&s!==0&&(t.position.y+=15,t.position.y+=f*s)),l.Direction=="Right"&&(t.position.x+=o.image.width*o.scale.x/4/a,r="LEFT",n.length>0&&s!==0&&(t.position.y+=f*s)),l.Direction=="Left"&&(t.position.x-=o.image.width*o.scale.x/4/a,r="RIGHT",n.length>0&&s!==0&&(t.position.y-=f*s)),n.length>0&&s!==0&&(u=0,y=0),t.style={backgroundColor:N,backgroundOpacity:+b/100,pointerDirection:r,pointerWidth:y,pointerHeight:u,cornerRadius:10},t.text.style.strokeOpacity=T,t.text.style.fillOpacity=T,await d.scene.items.addItems([t])}else await d.scene.items.deleteItems([g]);function i(n){switch(n){case"Top":return"DOWN";case"Bottom":return"UP";case"Right":return"LEFT";case"Left":return"RIGHT";default:throw new Error("Invalid direction")}}}}d.onReady(async()=>{document.documentElement.style.borderRadius="16px",document.documentElement.style.height="100%";const L=window.location.search,o=new URLSearchParams(L),l=o.get("targetid"),h=o.get("multi"),b=h?l.split(","):[];let g=[];const E=await d.scene.items.getItems(h?b:[l]);h||(g=await d.scene.items.getItems(i=>i.attachedTo===E[0].id&&i.type==="LABEL"));const N=await d.theme.getTheme();x(N,document),d.theme.onChange(i=>{x(i,document)});const a=(await d.room.getMetadata())[`${w.EXTENSIONID}/metadata_marks`]?.saveData;if(a&&a.Labels?.length>0){let i=function(e){e==="#1"?(n.style.display="",p.style.display="none",t.style.display="none"):e==="#2"?(n.style.display="none",p.style.display="",t.style.display="none"):(n.style.display="none",p.style.display="none",t.style.display="")};const n=document.querySelector("#label-list1"),p=document.querySelector("#label-list2"),t=document.querySelector("#label-list3"),r=document.createElement("button");r.className="categoryButton",r.onclick=()=>i("#1");const u=document.createElement("button");u.className="categoryButton",u.onclick=()=>i("#2");const y=document.createElement("button");y.className="categoryButton",y.onclick=()=>i("#3");const c=document.querySelector(".footered");c.appendChild(r),c.appendChild(u),c.appendChild(y),a.Groups.forEach(e=>{switch(e.Num){case"#1":r.innerText=e.Name;break;case"#2":u.innerText=e.Name;break;case"#3":y.innerText=e.Name;break;default:throw new Error("Invalid Group")}}),a.Labels.forEach(e=>{if(e.Active){const I=g.find(k=>k.text.plainText===e.Name),m=document.createElement("button");m.id=`toggle-${e.Id}`,m.className=`group1${I?" highlight":""}`,m.value=e.Name,m.title=e.Name,m.textContent=e.Name,e.Group==="#1"?n.appendChild(m):e.Group==="#2"?p.appendChild(m):t.appendChild(m)}}),document.querySelectorAll(".group1").forEach(e=>{e.addEventListener("click",async I=>await s(I.currentTarget))}),i("#1")}else document.querySelector("#label-list1").innerHTML=`
        <div>
        No labels found.
        </div>`;async function s(i){const n=i.id.substring(7),p=a.Labels.find(t=>t.Id===n);h||(i.className=i.className==="group1"?"group1 highlight":"group1"),E.forEach(async t=>{await B.UpdateLabel(t,p,a.Distance,a.Opacity)})}});
