import{a as k,O as l,C as w,b as S,S as x}from"./style-0a7c21db.js";class B{static async UpdateLabel(o,a){const m=k(o.id,a.Id),E=await l.scene.items.getItems([m]),f="#242424";let s=0;if(E.length===0){const c=await l.scene.items.getItems(i=>i.attachedTo===o.id&&i.type==="LABEL"&&i.style.pointerDirection===I(a.Direction));if(c.length>0){for(let i=0;i<c.length+1;i++)if(!c.find(h=>h.metadata[`${w.EXTENSIONID}/place`].placement===i)){s=i;break}}let N={};N[`${w.EXTENSIONID}/place`]={placement:s};const t=S().fillColor(a.Color).plainText(a.Name).strokeWidth(5).build();t.id=m,t.type="LABEL",t.attachedTo=o.id,t.visible=!!o.visible,t.locked=!0,t.position={x:o.position.x,y:o.position.y},t.metadata=N;let p,n=15,r=15;a.Direction=="Top"&&(t.position.y-=o.image.height*o.scale.y/4,p="DOWN",c.length>0&&s!==0&&(t.position.y-=15,t.position.y-=35*s)),a.Direction=="Bottom"&&(t.position.y+=o.image.height*o.scale.y/4,p="UP",c.length>0&&s!==0&&(t.position.y+=15,t.position.y+=35*s)),a.Direction=="Right"&&(t.position.x+=o.image.width*o.scale.x/4,p="LEFT",c.length>0&&s!==0&&(t.position.y+=35*s)),a.Direction=="Left"&&(t.position.x-=o.image.width*o.scale.x/4,p="RIGHT",c.length>0&&s!==0&&(t.position.y-=35*s)),c.length>0&&s!==0&&(n=0,r=0),t.style={backgroundColor:f,backgroundOpacity:.85,pointerDirection:p,pointerWidth:r,pointerHeight:n,cornerRadius:10},await l.scene.items.addItems([t])}else await l.scene.items.deleteItems([m]);function I(c){switch(c){case"Top":return"DOWN";case"Bottom":return"UP";case"Right":return"LEFT";case"Left":return"RIGHT";default:throw new Error("Invalid direction")}}}}l.onReady(async()=>{document.documentElement.style.borderRadius="16px",document.documentElement.style.height="100%";const L=window.location.search,o=new URLSearchParams(L),a=o.get("targetid"),m=o.get("multi"),E=m?a.split(","):[];let f=[];const s=await l.scene.items.getItems(m?E:[a]);m||(f=await l.scene.items.getItems(n=>n.attachedTo===s[0].id&&n.type==="LABEL"));const I=await l.theme.getTheme();x(I,document),l.theme.onChange(n=>{x(n,document)});const t=(await l.room.getMetadata())[`${w.EXTENSIONID}/metadata_marks`]?.saveData;if(t&&t.Labels?.length>0){let n=function(e){e==="#1"?(r.style.display="",i.style.display="none",d.style.display="none"):e==="#2"?(r.style.display="none",i.style.display="",d.style.display="none"):(r.style.display="none",i.style.display="none",d.style.display="")};const r=document.querySelector("#label-list1"),i=document.querySelector("#label-list2"),d=document.querySelector("#label-list3"),h=document.createElement("button");h.className="categoryButton",h.onclick=()=>n("#1");const y=document.createElement("button");y.className="categoryButton",y.onclick=()=>n("#2");const g=document.createElement("button");g.className="categoryButton",g.onclick=()=>n("#3");const T=document.querySelector(".footered");T.appendChild(h),T.appendChild(y),T.appendChild(g),t.Groups.forEach(e=>{switch(e.Num){case"#1":h.innerText=e.Name;break;case"#2":y.innerText=e.Name;break;case"#3":g.innerText=e.Name;break;default:throw new Error("Invalid Group")}}),t.Labels.forEach(e=>{if(e.Active){const b=f.find(C=>C.text.plainText===e.Name),u=document.createElement("button");u.id=`toggle-${e.Id}`,u.className=`group1${b?" highlight":""}`,u.value=e.Name,u.title=e.Name,u.textContent=e.Name,e.Group==="#1"?r.appendChild(u):e.Group==="#2"?i.appendChild(u):d.appendChild(u)}}),document.querySelectorAll(".group1").forEach(e=>{e.addEventListener("click",async b=>await p(b.currentTarget))}),n("#1")}else document.querySelector("#label-list1").innerHTML=`
        <div>
        No labels found.
        </div>`;async function p(n){const r=n.id.substring(7),i=t.Labels.find(d=>d.Id===r);m||(n.className=n.className==="group1"?"group1 highlight":"group1"),s.forEach(async d=>{await B.UpdateLabel(d,i)})}});
