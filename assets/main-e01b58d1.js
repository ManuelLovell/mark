import{O as B,C as J,S as be,G as _e,H as qe,R as Ve}from"./style-b76273e9.js";const $e="com.tutorial.initiative-tracker";function je(){B.contextMenu.create({id:`${$e}/context-menu`,icons:[{icon:"/tag1.svg",label:"Mark It",filter:{every:[{key:"layer",value:"CHARACTER"}]}}],async onClick(s,l){s.items.length==1?await B.popover.open({id:J.LABELSID,url:`/labelpicker.html?targetid=${s.items[0].id}`,height:250,width:300,anchorElementId:l}):await B.popover.open({id:J.LABELSID,url:`/labelpicker.html?targetid=${s.items.map(o=>o.id).toString()}&multi=true`,height:250,width:300,anchorElementId:l})}})}var N=function(){/*!
* Copyright (c) 2021-2023 Momo Bassit.
* Licensed under the MIT License (MIT)
* https://github.com/mdbassit/Coloris
* Version: 0.19.0
* NPM: https://github.com/melloware/coloris-npm
*/return function(s,l,o){var f=l.createElement("canvas").getContext("2d"),p={r:0,g:0,b:0,h:0,s:0,v:0,a:1},b,c,F,w,y,v,m,A,C,I,G,T,H,L,V,M,Q,r={el:"[data-coloris]",parent:"body",theme:"default",themeMode:"light",rtl:!1,wrap:!0,margin:2,format:"hex",formatToggle:!1,swatches:[],swatchesOnly:!1,alpha:!0,forceAlpha:!1,focusInput:!0,selectInput:!1,inline:!1,defaultColor:"#000000",clearButton:!1,clearLabel:"Clear",closeButton:!1,closeLabel:"Close",onChange:function(){},a11y:{open:"Open color picker",close:"Close color picker",clear:"Clear the selected color",marker:"Saturation: {s}. Brightness: {v}.",hueSlider:"Hue slider",alphaSlider:"Opacity slider",input:"Color value field",format:"Color format",swatch:"Color swatch",instruction:"Saturation and brightness selector. Use up, down, left and right arrow keys to select."}},$={},Z="",j={},W=!1;function z(e){if(typeof e=="object"){var t=function(){switch(a){case"el":te(e.el),e.wrap!==!1&&U(e.el);break;case"parent":b=l.querySelector(e.parent),b&&(b.appendChild(c),r.parent=e.parent,b===l.body&&(b=null));break;case"themeMode":r.themeMode=e.themeMode,e.themeMode==="auto"&&s.matchMedia&&s.matchMedia("(prefers-color-scheme: dark)").matches&&(r.themeMode="dark");case"theme":e.theme&&(r.theme=e.theme),c.className="clr-picker clr-"+r.theme+" clr-"+r.themeMode,r.inline&&X();break;case"rtl":r.rtl=!!e.rtl,l.querySelectorAll(".clr-field").forEach(function(S){return S.classList.toggle("clr-rtl",r.rtl)});break;case"margin":e.margin*=1,r.margin=isNaN(e.margin)?r.margin:e.margin;break;case"wrap":e.el&&e.wrap&&U(e.el);break;case"formatToggle":r.formatToggle=!!e.formatToggle,x("clr-format").style.display=r.formatToggle?"block":"none",r.formatToggle&&(r.format="auto");break;case"swatches":if(Array.isArray(e.swatches)){var i=[];e.swatches.forEach(function(S,ye){i.push('<button type="button" id="clr-swatch-'+ye+'" aria-labelledby="clr-swatch-label clr-swatch-'+ye+'" style="color: '+S+';">'+S+"</button>")}),x("clr-swatches").innerHTML=i.length?"<div>"+i.join("")+"</div>":"",r.swatches=e.swatches.slice()}break;case"swatchesOnly":r.swatchesOnly=!!e.swatchesOnly,c.setAttribute("data-minimal",r.swatchesOnly);break;case"alpha":r.alpha=!!e.alpha,c.setAttribute("data-alpha",r.alpha);break;case"inline":if(r.inline=!!e.inline,c.setAttribute("data-inline",r.inline),r.inline){var u=e.defaultColor||r.defaultColor;V=ae(u),X(),Y(u)}break;case"clearButton":typeof e.clearButton=="object"&&(e.clearButton.label&&(r.clearLabel=e.clearButton.label,A.innerHTML=r.clearLabel),e.clearButton=e.clearButton.show),r.clearButton=!!e.clearButton,A.style.display=r.clearButton?"block":"none";break;case"clearLabel":r.clearLabel=e.clearLabel,A.innerHTML=r.clearLabel;break;case"closeButton":r.closeButton=!!e.closeButton,r.closeButton?c.insertBefore(C,v):v.appendChild(C);break;case"closeLabel":r.closeLabel=e.closeLabel,C.innerHTML=r.closeLabel;break;case"a11y":var d=e.a11y,k=!1;if(typeof d=="object")for(var h in d)d[h]&&r.a11y[h]&&(r.a11y[h]=d[h],k=!0);if(k){var E=x("clr-open-label"),D=x("clr-swatch-label");E.innerHTML=r.a11y.open,D.innerHTML=r.a11y.swatch,C.setAttribute("aria-label",r.a11y.close),A.setAttribute("aria-label",r.a11y.clear),I.setAttribute("aria-label",r.a11y.hueSlider),T.setAttribute("aria-label",r.a11y.alphaSlider),m.setAttribute("aria-label",r.a11y.input),F.setAttribute("aria-label",r.a11y.instruction)}break;default:r[a]=e[a]}};for(var a in e)t()}}function Le(e,t){typeof e=="string"&&typeof t=="object"&&($[e]=t,W=!0)}function Ee(e){delete $[e],Object.keys($).length===0&&(W=!1,e===Z&&ee())}function fe(e){if(W){var t=["el","wrap","rtl","inline","defaultColor","a11y"],a=function(){var d=$[n];if(e.matches(n)){Z=n,j={},t.forEach(function(h){return delete d[h]});for(var k in d)j[k]=Array.isArray(r[k])?r[k].slice():r[k];return z(d),"break"}};for(var n in $){var i=a();if(i==="break")break}}}function ee(){Object.keys(j).length>0&&(z(j),Z="",j={})}function te(e){g(l,"click",e,function(t){r.inline||(fe(t.target),L=t.target,M=L.value,V=ae(M),c.classList.add("clr-open"),X(),Y(M),(r.focusInput||r.selectInput)&&m.focus({preventScroll:!0}),r.selectInput&&m.select(),(Q||r.swatchesOnly)&&me().shift().focus(),L.dispatchEvent(new Event("open",{bubbles:!0})))}),g(l,"input",e,function(t){var a=t.target.parentNode;a.classList.contains("clr-field")&&(a.style.color=t.target.value)})}function X(){if(!(!c||!L&&!r.inline)){var e=b,t=s.scrollY,a=c.offsetWidth,n=c.offsetHeight,i={left:!1,top:!1},u,d,k,h={x:0,y:0};if(e&&(u=s.getComputedStyle(e),d=parseFloat(u.marginTop),k=parseFloat(u.borderTopWidth),h=e.getBoundingClientRect(),h.y+=k+t),!r.inline){var E=L.getBoundingClientRect(),D=E.x,S=t+E.y+E.height+r.margin;e?(D-=h.x,S-=h.y,D+a>e.clientWidth&&(D+=E.width-a,i.left=!0),S+n>e.clientHeight-d&&n+r.margin<=E.top-(h.y-t)&&(S-=E.height+n+r.margin*2,i.top=!0),S+=e.scrollTop):(D+a>l.documentElement.clientWidth&&(D+=E.width-a,i.left=!0),S+n-t>l.documentElement.clientHeight&&n+r.margin<=E.top&&(S=t+E.y-n-r.margin,i.top=!0)),c.classList.toggle("clr-left",i.left),c.classList.toggle("clr-top",i.top),c.style.left=D+"px",c.style.top=S+"px",h.x+=c.offsetLeft,h.y+=c.offsetTop}w={width:F.offsetWidth,height:F.offsetHeight,x:F.offsetLeft+h.x,y:F.offsetTop+h.y}}}function U(e){l.querySelectorAll(e).forEach(function(t){var a=t.parentNode;if(!a.classList.contains("clr-field")){var n=l.createElement("div"),i="clr-field";(r.rtl||t.classList.contains("clr-rtl"))&&(i+=" clr-rtl"),n.innerHTML='<button type="button" aria-labelledby="clr-open-label"></button>',a.insertBefore(n,t),n.setAttribute("class",i),n.style.color=t.value,n.appendChild(t)}})}function q(e){if(L&&!r.inline){var t=L;e&&(L=null,M!==t.value&&(t.value=M,t.dispatchEvent(new Event("input",{bubbles:!0})))),setTimeout(function(){M!==t.value&&t.dispatchEvent(new Event("change",{bubbles:!0}))}),c.classList.remove("clr-open"),W&&ee(),t.dispatchEvent(new Event("close",{bubbles:!0})),r.focusInput&&t.focus({preventScroll:!0}),L=null}}function Y(e){var t=Ge(e),a=De(t);he(a.s,a.v),K(t,a),I.value=a.h,c.style.color="hsl("+a.h+", 100%, 50%)",G.style.left=a.h/360*100+"%",y.style.left=w.width*a.s/100+"px",y.style.top=w.height-w.height*a.v/100+"px",T.value=a.a*100,H.style.left=a.a*100+"%"}function ae(e){var t=e.substring(0,3).toLowerCase();return t==="rgb"||t==="hsl"?t:"hex"}function R(e){e=e!==void 0?e:m.value,L&&(L.value=e,L.dispatchEvent(new Event("input",{bubbles:!0}))),r.onChange&&r.onChange.call(s,e),l.dispatchEvent(new CustomEvent("coloris:pick",{detail:{color:e}}))}function pe(e,t){var a={h:I.value*1,s:e/w.width*100,v:100-t/w.height*100,a:T.value/100},n=Be(a);he(a.s,a.v),K(n,a),R()}function he(e,t){var a=r.a11y.marker;e=e.toFixed(1)*1,t=t.toFixed(1)*1,a=a.replace("{s}",e),a=a.replace("{v}",t),y.setAttribute("aria-label",a)}function xe(e){return{pageX:e.changedTouches?e.changedTouches[0].pageX:e.pageX,pageY:e.changedTouches?e.changedTouches[0].pageY:e.pageY}}function O(e){var t=xe(e),a=t.pageX-w.x,n=t.pageY-w.y;b&&(n+=b.scrollTop),ve(a,n),e.preventDefault(),e.stopPropagation()}function Te(e,t){var a=y.style.left.replace("px","")*1+e,n=y.style.top.replace("px","")*1+t;ve(a,n)}function ve(e,t){e=e<0?0:e>w.width?w.width:e,t=t<0?0:t>w.height?w.height:t,y.style.left=e+"px",y.style.top=t+"px",pe(e,t),y.focus()}function K(e,t){e===void 0&&(e={}),t===void 0&&(t={});var a=r.format;for(var n in e)p[n]=e[n];for(var i in t)p[i]=t[i];var u=He(p),d=u.substring(0,7);switch(y.style.color=d,H.parentNode.style.color=d,H.style.color=u,v.style.color=u,F.style.display="none",F.offsetHeight,F.style.display="",H.nextElementSibling.style.display="none",H.nextElementSibling.offsetHeight,H.nextElementSibling.style.display="",a==="mixed"?a=p.a===1?"hex":"rgb":a==="auto"&&(a=V),a){case"hex":m.value=u;break;case"rgb":m.value=Me(p);break;case"hsl":m.value=Re(Ne(p));break}l.querySelector('.clr-format [value="'+a+'"]').checked=!0}function Ie(){var e=I.value*1,t=y.style.left.replace("px","")*1,a=y.style.top.replace("px","")*1;c.style.color="hsl("+e+", 100%, 50%)",G.style.left=e/360*100+"%",pe(t,a)}function Se(){var e=T.value/100;H.style.left=e*100+"%",K({a:e}),R()}function Be(e){var t=e.s/100,a=e.v/100,n=t*a,i=e.h/60,u=n*(1-o.abs(i%2-1)),d=a-n;n=n+d,u=u+d;var k=o.floor(i)%6,h=[n,u,d,d,u,n][k],E=[u,n,n,u,d,d][k],D=[d,d,u,n,n,u][k];return{r:o.round(h*255),g:o.round(E*255),b:o.round(D*255),a:e.a}}function Ne(e){var t=e.v/100,a=t*(1-e.s/100/2),n;return a>0&&a<1&&(n=o.round((t-a)/o.min(a,1-a)*100)),{h:e.h,s:n||0,l:o.round(a*100),a:e.a}}function De(e){var t=e.r/255,a=e.g/255,n=e.b/255,i=o.max(t,a,n),u=o.min(t,a,n),d=i-u,k=i,h=0,E=0;return d&&(i===t&&(h=(a-n)/d),i===a&&(h=2+(n-t)/d),i===n&&(h=4+(t-a)/d),i&&(E=d/i)),h=o.floor(h*60),{h:h<0?h+360:h,s:o.round(E*100),v:o.round(k*100),a:e.a}}function Ge(e){var t=/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,a,n;return f.fillStyle="#000",f.fillStyle=e,a=t.exec(f.fillStyle),a?(n={r:a[3]*1,g:a[4]*1,b:a[5]*1,a:a[6]*1},n.a=+n.a.toFixed(2)):(a=f.fillStyle.replace("#","").match(/.{2}/g).map(function(i){return parseInt(i,16)}),n={r:a[0],g:a[1],b:a[2],a:1}),n}function He(e){var t=e.r.toString(16),a=e.g.toString(16),n=e.b.toString(16),i="";if(e.r<16&&(t="0"+t),e.g<16&&(a="0"+a),e.b<16&&(n="0"+n),r.alpha&&(e.a<1||r.forceAlpha)){var u=e.a*255|0;i=u.toString(16),u<16&&(i="0"+i)}return"#"+t+a+n+i}function Me(e){return!r.alpha||e.a===1&&!r.forceAlpha?"rgb("+e.r+", "+e.g+", "+e.b+")":"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"}function Re(e){return!r.alpha||e.a===1&&!r.forceAlpha?"hsl("+e.h+", "+e.s+"%, "+e.l+"%)":"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"}function Oe(){l.getElementById("clr-picker")||(b=null,c=l.createElement("div"),c.setAttribute("id","clr-picker"),c.className="clr-picker",c.innerHTML='<input id="clr-color-value" name="clr-color-value" class="clr-color" type="text" value="" spellcheck="false" aria-label="'+r.a11y.input+'">'+('<div id="clr-color-area" class="clr-gradient" role="application" aria-label="'+r.a11y.instruction+'">')+'<div id="clr-color-marker" class="clr-marker" tabindex="0"></div></div><div class="clr-hue">'+('<input id="clr-hue-slider" name="clr-hue-slider" type="range" min="0" max="360" step="1" aria-label="'+r.a11y.hueSlider+'">')+'<div id="clr-hue-marker"></div></div><div class="clr-alpha">'+('<input id="clr-alpha-slider" name="clr-alpha-slider" type="range" min="0" max="100" step="1" aria-label="'+r.a11y.alphaSlider+'">')+'<div id="clr-alpha-marker"></div><span></span></div><div id="clr-format" class="clr-format"><fieldset class="clr-segmented">'+("<legend>"+r.a11y.format+"</legend>")+'<input id="clr-f1" type="radio" name="clr-format" value="hex"><label for="clr-f1">Hex</label><input id="clr-f2" type="radio" name="clr-format" value="rgb"><label for="clr-f2">RGB</label><input id="clr-f3" type="radio" name="clr-format" value="hsl"><label for="clr-f3">HSL</label><span></span></fieldset></div><div id="clr-swatches" class="clr-swatches"></div>'+('<button type="button" id="clr-clear" class="clr-clear" aria-label="'+r.a11y.clear+'">'+r.clearLabel+"</button>")+'<div id="clr-color-preview" class="clr-preview">'+('<button type="button" id="clr-close" class="clr-close" aria-label="'+r.a11y.close+'">'+r.closeLabel+"</button>")+"</div>"+('<span id="clr-open-label" hidden>'+r.a11y.open+"</span>")+('<span id="clr-swatch-label" hidden>'+r.a11y.swatch+"</span>"),l.body.appendChild(c),F=x("clr-color-area"),y=x("clr-color-marker"),A=x("clr-clear"),C=x("clr-close"),v=x("clr-color-preview"),m=x("clr-color-value"),I=x("clr-hue-slider"),G=x("clr-hue-marker"),T=x("clr-alpha-slider"),H=x("clr-alpha-marker"),te(r.el),U(r.el),g(c,"mousedown",function(e){c.classList.remove("clr-keyboard-nav"),e.stopPropagation()}),g(F,"mousedown",function(e){g(l,"mousemove",O)}),g(F,"touchstart",function(e){l.addEventListener("touchmove",O,{passive:!1})}),g(y,"mousedown",function(e){g(l,"mousemove",O)}),g(y,"touchstart",function(e){l.addEventListener("touchmove",O,{passive:!1})}),g(m,"change",function(e){(L||r.inline)&&(Y(m.value),R())}),g(A,"click",function(e){R(""),q()}),g(C,"click",function(e){R(),q()}),g(l,"click",".clr-format input",function(e){V=e.target.value,K(),R()}),g(c,"click",".clr-swatches button",function(e){Y(e.target.textContent),R(),r.swatchesOnly&&q()}),g(l,"mouseup",function(e){l.removeEventListener("mousemove",O)}),g(l,"touchend",function(e){l.removeEventListener("touchmove",O)}),g(l,"mousedown",function(e){Q=!1,c.classList.remove("clr-keyboard-nav"),q()}),g(l,"keydown",function(e){var t=e.key,a=e.target,n=e.shiftKey,i=["Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"];if(t==="Escape"?q(!0):i.includes(t)&&(Q=!0,c.classList.add("clr-keyboard-nav")),t==="Tab"&&a.matches(".clr-picker *")){var u=me(),d=u.shift(),k=u.pop();n&&a===d?(k.focus(),e.preventDefault()):!n&&a===k&&(d.focus(),e.preventDefault())}}),g(l,"click",".clr-field button",function(e){W&&ee(),e.target.nextElementSibling.dispatchEvent(new Event("click",{bubbles:!0}))}),g(y,"keydown",function(e){var t={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};Object.keys(t).includes(e.key)&&(Te.apply(void 0,t[e.key]),e.preventDefault())}),g(F,"click",O),g(I,"input",Ie),g(T,"input",Se))}function me(){var e=Array.from(c.querySelectorAll("input, button")),t=e.filter(function(a){return!!a.offsetWidth});return t}function x(e){return l.getElementById(e)}function g(e,t,a,n){var i=Element.prototype.matches||Element.prototype.msMatchesSelector;typeof a=="string"?e.addEventListener(t,function(u){i.call(u.target,a)&&n.call(u.target,u)}):(n=a,e.addEventListener(t,n))}function re(e,t){t=t!==void 0?t:[],l.readyState!=="loading"?e.apply(void 0,t):l.addEventListener("DOMContentLoaded",function(){e.apply(void 0,t)})}NodeList!==void 0&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);function Pe(e,t){L=t,M=L.value,fe(t),V=ae(e),X(),Y(e),R(),M!==e&&L.dispatchEvent(new Event("change",{bubbles:!0}))}var ne=function(){var e={init:Oe,set:z,wrap:U,close:q,setInstance:Le,setColor:Pe,removeInstance:Ee,updatePosition:X};function t(i){re(function(){i&&(typeof i=="string"?te(i):z(i))})}var a=function(u){t[u]=function(){for(var d=arguments.length,k=new Array(d),h=0;h<d;h++)k[h]=arguments[h];re(e[u],k)}};for(var n in e)a(n);return re(function(){s.addEventListener("resize",function(i){t.updatePosition()}),s.addEventListener("scroll",function(i){t.updatePosition()})}),t}();return ne.coloris=ne,ne}(window,document,Math)}();N.coloris;N.init;N.set;N.wrap;N.close;N.setInstance;N.removeInstance;N.updatePosition;N.init();N.coloris({el:".coloris",alpha:!1,format:"hex",wrap:!0,theme:"polaroid",themeMode:"light",swatches:["red","yellow","green","cyan","blue","purple"],onChange:s=>{console.log(s)}});N.close();document.querySelector("#app").innerHTML=`
  <div id="loadingApp" class="center">Loading...</div>
  <div id="labelApp" style="display:none;">
  <div id="buttonLabels">
  <div class="nameGroup center">
  <label for="gr1n">Group #1</label><br>
  <input type="text" id="gr1n" name="gr1n" maxlength="15" size="10">
  </div>
  <div class="nameGroup center">
  <label for="gr2n">Group #2</label><br>
  <input type="text" id="gr2n" name="gr2n" maxlength="15" size="10">
  </div>
  <div class="nameGroup center">
  <label for="gr3n">Group #3</label><br>
  <input type="text" id="gr3n" name="gr3n" maxlength="15" size="10">
  </div>
  </div>
  <div id="mainButtonsGroup" class="center">
  <label for="distance">Spacing: </label><input type="number" id="distance" name="distance">
  <label for="distance">Opacity: </label><input type="number" id="opacity" name="opacity">
  <div id="mainButtons"></div></div>
  <hr style="height:1px; visibility:hidden;" />
  <table id="table-one" style="width:100%">
  <thead>
  <tr id="tableHeader">
  <th style="width: 5%">🔛</th>
  <th id="labelSort" style="width: 55%">Label Name</th>
  <th style="width: 10%">Group</th>
  <th style="width: 20%">Direction</th>
  <th style="width: 10%">🖍️</th>
  </tr>
  </thead>
  <tbody id="label-list"></tbody>
  </table>
  </div>
  `;const ge=document.getElementById("loadingApp"),We=document.getElementById("labelApp"),we=document.getElementById("label-list"),Xe=document.getElementById("labelSort");let le=!0;const ie=document.getElementById("mainButtons"),se=document.getElementById("gr1n"),ue=document.getElementById("gr2n"),de=document.getElementById("gr3n"),P=document.getElementById("distance"),_=document.getElementById("opacity"),Ye=[{Id:"1",Name:"Blinded 🕶️",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"2",Name:"Charmed 💘",Color:"#ff0000",Group:"#1",Direction:"Top",Active:1},{Id:"3",Name:"Deafened 🎧",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"4",Name:"Frightened 😱",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"5",Name:"Grappled 🫂",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"6",Name:"Incapacitated 💘",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"7",Name:"Invisible 😶‍🌫️",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"8",Name:"Paralyzed ⚡",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"9",Name:"Petrified 🪨",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"10",Name:"Poisoned 🤢",Color:"#008000",Group:"#1",Direction:"Top",Active:1},{Id:"11",Name:"Prone 🦦",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"12",Name:"Restrained 🪢",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"13",Name:"Stunned 💫",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"14",Name:"Unconscious 💤",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"15",Name:"Exhaustion 🦥",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"16",Name:"Bardic Inspiration 🎵",Color:"#FFFFFF",Group:"#2",Direction:"Left",Active:1},{Id:"17",Name:"Champion 👑",Color:"#FFFFFF",Group:"#3",Direction:"Right",Active:1}],oe=["Conditions","Buffs","Extra"],ke="35",Fe="85";B.onReady(async()=>{je();const s=await B.theme.getTheme();be(s,document),B.theme.onChange(o=>{be(o,document)}),await B.player.getRole()==="GM"?await Qe():(ge.innerHTML="Configuration is GM-Access only.",await B.action.setHeight(70),await B.action.setWidth(150))});function ce(s){const l=we.insertRow(0);l.className="data-row",l.id=_e();const o=l.insertCell(0),f=l.insertCell(1);f.id="name_"+l.id,f.setAttribute("contenteditable","true"),f.innerHTML=s?s.Name:"Default Name";const p=l.insertCell(2);p.className="center";const b=Ke();b.value=s?s.Group:"#1",b.id="group_"+l.id,p.appendChild(b);const c=l.insertCell(3);c.className="center";const F=Ue();F.value=s?s.Direction:"Top",F.id="selector_"+l.id,c.appendChild(F);const w=l.insertCell(4);w.id=l.id,w.className="center",o.innerHTML=`<input id="checkbox_${l.id}" type="checkbox" ${s?.Active===0?"":"checked"}/>`;const y=s?qe(s.Color):void 0;w.appendChild(ze(w.id,y))}function ze(s,l){const o=document.createElement("div"),f=document.createElement("button");f.setAttribute("aria-labelledby","clr-open-label"),f.id="clr-button_"+s,o.className="clr-field",o.id="clr-field_"+s,o.style.color=l?"rgb"+l:"rgb(0, 0, 0)",o.appendChild(f);const p=document.createElement("input");return p.type="text",p.id="clr-input_"+s,p.style.width="20px",p.className="coloris",p.setAttribute("data-coloris",""),o.appendChild(p),o}function Ue(){const s=document.createElement("select");return["Top","Bottom","Left","Right"].forEach(o=>{const f=document.createElement("option");f.setAttribute("value",o);const p=document.createTextNode(o);f.appendChild(p),s.appendChild(f)}),s}function Ke(){const s=document.createElement("select");return["#1","#2","#3"].forEach(o=>{const f=document.createElement("option");f.setAttribute("value",o);const p=document.createTextNode(o);f.appendChild(p),s.appendChild(f)}),s}async function Ce(){const s=[],l=[],o=P.value,f=_.value;for(var p=document.getElementById("label-list"),b=0,c;c=p.rows[b];b++){const y=c.id,v=c.querySelector("#checkbox_"+y),m=c.querySelector("#name_"+y),A=c.querySelector("#selector_"+y),C=c.querySelector("#group_"+y),I=c.querySelector("#clr-field_"+y),G=Ve(I.style.color),T={Id:y,Active:v.checked?1:0,Name:m.innerText,Direction:A.value,Color:G,Group:C.value};s.push(T)}l.push({Name:se.value,Num:"#1"}),l.push({Name:ue.value,Num:"#2"}),l.push({Name:de.value,Num:"#3"});const F={Groups:l,Labels:s.reverse(),Distance:o,Opacity:f};let w={};w[`${J.EXTENSIONID}/metadata_marks`]={saveData:F},await B.room.setMetadata(w)}async function Je(){confirm("Erase everything and go back to default labels?")&&(we.innerHTML="",await Ae())}async function Ae(){se.value=oe[0],ue.value=oe[1],de.value=oe[2],P.value=ke,_.value=Fe,Ye.forEach(s=>{ce(s)}),await Ce()}async function Qe(){const o=(await B.room.getMetadata())[`${J.EXTENSIONID}/metadata_marks`]?.saveData;o&&o.Labels?.length>0?(o.Labels.forEach(v=>{ce(v)}),o.Groups.forEach(v=>{switch(v.Num){case"#1":se.value=v.Name;break;case"#2":ue.value=v.Name;break;case"#3":de.value=v.Name;break;default:throw new Error("Invalid Group")}})):await Ae(),P.max="999",P.min="1",P.maxLength=4,P.value=o?.Distance?o.Distance:ke,P.oninput=v=>{F(v.target)},_.max="99",_.min="1",_.maxLength=2,_.value=o?.Opacity?o.Opacity:Fe,_.oninput=v=>{F(v.target)};const f=document.createElement("input");f.type="image",f.className="Icon clickable",f.id="saveButton",f.onclick=async function(){await Ce()},f.src="/save.svg",f.title="Save Changes",f.height=20,f.width=20,ie.appendChild(f);const p=document.createElement("input");p.type="image",p.className="Icon clickable",p.id="addButton",p.onclick=async function(){await ce()},p.src="/add.svg",p.title="Add Label",p.height=20,p.width=20,ie.appendChild(p);const b=document.createElement("input");b.type="image",b.className="Icon clickable",b.id="addButton",b.onclick=async function(){await Je()},b.src="/reset.svg",b.title="Reset to Default Labels",b.height=20,b.width=20,ie.appendChild(b),Xe.onclick=async function(){var v,m,A,C,I,G,T;for(v=document.getElementById("label-list"),A=!0;A;){for(A=!1,m=v.getElementsByClassName("data-row"),C=0;C<m.length-1;C++)if(T=!1,I=m[C].getElementsByTagName("td")[1],G=m[C+1].getElementsByTagName("td")[1],le){if(I.innerHTML.toLowerCase()>G.innerHTML.toLowerCase()){T=!0;break}}else if(I.innerHTML.toLowerCase()<G.innerHTML.toLowerCase()){T=!0;break}T&&(m[C].parentNode.insertBefore(m[C+1],m[C]),A=!0)}le=!le},ge.style.display="none",We.style.display="";function c(v){return parseInt(v)}function F(v){let m=v.min,A=v.max,C=c(v.value);C>A?v.value=A:C<m&&(v.value=m)}function w(v){v.preventDefault();const m=v.target.closest("tr");m&&m.rowIndex>0&&window.confirm(`Are you sure you want to delete ${m.children[1].innerHTML}?`)&&m.remove()}const y=document.getElementById("table-one");y&&y.addEventListener("contextmenu",w)}
