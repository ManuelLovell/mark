import{O as I,C as K,S as me,G as Re,H as Oe,R as Pe}from"./style-edbabba7.js";const _e="com.tutorial.initiative-tracker";function qe(){I.contextMenu.create({id:`${_e}/context-menu`,icons:[{icon:"/tag1.svg",label:"Mark It",filter:{every:[{key:"layer",value:"CHARACTER"}]}}],async onClick(o,l){o.items.length==1?await I.popover.open({id:K.LABELSID,url:`/labelpicker.html?targetid=${o.items[0].id}`,height:250,width:300,anchorElementId:l}):await I.popover.open({id:K.LABELSID,url:`/labelpicker.html?targetid=${o.items.map(c=>c.id).toString()}&multi=true`,height:250,width:300,anchorElementId:l})}})}var S=function(){/*!
* Copyright (c) 2021-2023 Momo Bassit.
* Licensed under the MIT License (MIT)
* https://github.com/mdbassit/Coloris
* Version: 0.19.0
* NPM: https://github.com/melloware/coloris-npm
*/return function(o,l,c){var p=l.createElement("canvas").getContext("2d"),f={r:0,g:0,b:0,h:0,s:0,v:0,a:1},h,s,k,m,y,b,w,x,T,N,_,O,D,C,q,G,J,r={el:"[data-coloris]",parent:"body",theme:"default",themeMode:"light",rtl:!1,wrap:!0,margin:2,format:"hex",formatToggle:!1,swatches:[],swatchesOnly:!1,alpha:!0,forceAlpha:!1,focusInput:!0,selectInput:!1,inline:!1,defaultColor:"#000000",clearButton:!1,clearLabel:"Clear",closeButton:!1,closeLabel:"Close",onChange:function(){},a11y:{open:"Open color picker",close:"Close color picker",clear:"Clear the selected color",marker:"Saturation: {s}. Brightness: {v}.",hueSlider:"Hue slider",alphaSlider:"Opacity slider",input:"Color value field",format:"Color format",swatch:"Color swatch",instruction:"Saturation and brightness selector. Use up, down, left and right arrow keys to select."}},V={},Q="",$={},j=!1;function Y(e){if(typeof e=="object"){var t=function(){switch(a){case"el":ee(e.el),e.wrap!==!1&&z(e.el);break;case"parent":h=l.querySelector(e.parent),h&&(h.appendChild(s),r.parent=e.parent,h===l.body&&(h=null));break;case"themeMode":r.themeMode=e.themeMode,e.themeMode==="auto"&&o.matchMedia&&o.matchMedia("(prefers-color-scheme: dark)").matches&&(r.themeMode="dark");case"theme":e.theme&&(r.theme=e.theme),s.className="clr-picker clr-"+r.theme+" clr-"+r.themeMode,r.inline&&W();break;case"rtl":r.rtl=!!e.rtl,l.querySelectorAll(".clr-field").forEach(function(L){return L.classList.toggle("clr-rtl",r.rtl)});break;case"margin":e.margin*=1,r.margin=isNaN(e.margin)?r.margin:e.margin;break;case"wrap":e.el&&e.wrap&&z(e.el);break;case"formatToggle":r.formatToggle=!!e.formatToggle,E("clr-format").style.display=r.formatToggle?"block":"none",r.formatToggle&&(r.format="auto");break;case"swatches":if(Array.isArray(e.swatches)){var i=[];e.swatches.forEach(function(L,he){i.push('<button type="button" id="clr-swatch-'+he+'" aria-labelledby="clr-swatch-label clr-swatch-'+he+'" style="color: '+L+';">'+L+"</button>")}),E("clr-swatches").innerHTML=i.length?"<div>"+i.join("")+"</div>":"",r.swatches=e.swatches.slice()}break;case"swatchesOnly":r.swatchesOnly=!!e.swatchesOnly,s.setAttribute("data-minimal",r.swatchesOnly);break;case"alpha":r.alpha=!!e.alpha,s.setAttribute("data-alpha",r.alpha);break;case"inline":if(r.inline=!!e.inline,s.setAttribute("data-inline",r.inline),r.inline){var u=e.defaultColor||r.defaultColor;q=te(u),W(),X(u)}break;case"clearButton":typeof e.clearButton=="object"&&(e.clearButton.label&&(r.clearLabel=e.clearButton.label,x.innerHTML=r.clearLabel),e.clearButton=e.clearButton.show),r.clearButton=!!e.clearButton,x.style.display=r.clearButton?"block":"none";break;case"clearLabel":r.clearLabel=e.clearLabel,x.innerHTML=r.clearLabel;break;case"closeButton":r.closeButton=!!e.closeButton,r.closeButton?s.insertBefore(T,b):b.appendChild(T);break;case"closeLabel":r.closeLabel=e.closeLabel,T.innerHTML=r.closeLabel;break;case"a11y":var d=e.a11y,F=!1;if(typeof d=="object")for(var v in d)d[v]&&r.a11y[v]&&(r.a11y[v]=d[v],F=!0);if(F){var A=E("clr-open-label"),B=E("clr-swatch-label");A.innerHTML=r.a11y.open,B.innerHTML=r.a11y.swatch,T.setAttribute("aria-label",r.a11y.close),x.setAttribute("aria-label",r.a11y.clear),N.setAttribute("aria-label",r.a11y.hueSlider),O.setAttribute("aria-label",r.a11y.alphaSlider),w.setAttribute("aria-label",r.a11y.input),k.setAttribute("aria-label",r.a11y.instruction)}break;default:r[a]=e[a]}};for(var a in e)t()}}function we(e,t){typeof e=="string"&&typeof t=="object"&&(V[e]=t,j=!0)}function Ce(e){delete V[e],Object.keys(V).length===0&&(j=!1,e===Q&&Z())}function ue(e){if(j){var t=["el","wrap","rtl","inline","defaultColor","a11y"],a=function(){var d=V[n];if(e.matches(n)){Q=n,$={},t.forEach(function(v){return delete d[v]});for(var F in d)$[F]=Array.isArray(r[F])?r[F].slice():r[F];return Y(d),"break"}};for(var n in V){var i=a();if(i==="break")break}}}function Z(){Object.keys($).length>0&&(Y($),Q="",$={})}function ee(e){g(l,"click",e,function(t){r.inline||(ue(t.target),C=t.target,G=C.value,q=te(G),s.classList.add("clr-open"),W(),X(G),(r.focusInput||r.selectInput)&&w.focus({preventScroll:!0}),r.selectInput&&w.select(),(J||r.swatchesOnly)&&ve().shift().focus(),C.dispatchEvent(new Event("open",{bubbles:!0})))}),g(l,"input",e,function(t){var a=t.target.parentNode;a.classList.contains("clr-field")&&(a.style.color=t.target.value)})}function W(){if(!(!s||!C&&!r.inline)){var e=h,t=o.scrollY,a=s.offsetWidth,n=s.offsetHeight,i={left:!1,top:!1},u,d,F,v={x:0,y:0};if(e&&(u=o.getComputedStyle(e),d=parseFloat(u.marginTop),F=parseFloat(u.borderTopWidth),v=e.getBoundingClientRect(),v.y+=F+t),!r.inline){var A=C.getBoundingClientRect(),B=A.x,L=t+A.y+A.height+r.margin;e?(B-=v.x,L-=v.y,B+a>e.clientWidth&&(B+=A.width-a,i.left=!0),L+n>e.clientHeight-d&&n+r.margin<=A.top-(v.y-t)&&(L-=A.height+n+r.margin*2,i.top=!0),L+=e.scrollTop):(B+a>l.documentElement.clientWidth&&(B+=A.width-a,i.left=!0),L+n-t>l.documentElement.clientHeight&&n+r.margin<=A.top&&(L=t+A.y-n-r.margin,i.top=!0)),s.classList.toggle("clr-left",i.left),s.classList.toggle("clr-top",i.top),s.style.left=B+"px",s.style.top=L+"px",v.x+=s.offsetLeft,v.y+=s.offsetTop}m={width:k.offsetWidth,height:k.offsetHeight,x:k.offsetLeft+v.x,y:k.offsetTop+v.y}}}function z(e){l.querySelectorAll(e).forEach(function(t){var a=t.parentNode;if(!a.classList.contains("clr-field")){var n=l.createElement("div"),i="clr-field";(r.rtl||t.classList.contains("clr-rtl"))&&(i+=" clr-rtl"),n.innerHTML='<button type="button" aria-labelledby="clr-open-label"></button>',a.insertBefore(n,t),n.setAttribute("class",i),n.style.color=t.value,n.appendChild(t)}})}function P(e){if(C&&!r.inline){var t=C;e&&(C=null,G!==t.value&&(t.value=G,t.dispatchEvent(new Event("input",{bubbles:!0})))),setTimeout(function(){G!==t.value&&t.dispatchEvent(new Event("change",{bubbles:!0}))}),s.classList.remove("clr-open"),j&&Z(),t.dispatchEvent(new Event("close",{bubbles:!0})),r.focusInput&&t.focus({preventScroll:!0}),C=null}}function X(e){var t=Be(e),a=Se(t);fe(a.s,a.v),U(t,a),N.value=a.h,s.style.color="hsl("+a.h+", 100%, 50%)",_.style.left=a.h/360*100+"%",y.style.left=m.width*a.s/100+"px",y.style.top=m.height-m.height*a.v/100+"px",O.value=a.a*100,D.style.left=a.a*100+"%"}function te(e){var t=e.substring(0,3).toLowerCase();return t==="rgb"||t==="hsl"?t:"hex"}function H(e){e=e!==void 0?e:w.value,C&&(C.value=e,C.dispatchEvent(new Event("input",{bubbles:!0}))),r.onChange&&r.onChange.call(o,e),l.dispatchEvent(new CustomEvent("coloris:pick",{detail:{color:e}}))}function de(e,t){var a={h:N.value*1,s:e/m.width*100,v:100-t/m.height*100,a:O.value/100},n=Te(a);fe(a.s,a.v),U(n,a),H()}function fe(e,t){var a=r.a11y.marker;e=e.toFixed(1)*1,t=t.toFixed(1)*1,a=a.replace("{s}",e),a=a.replace("{v}",t),y.setAttribute("aria-label",a)}function Ae(e){return{pageX:e.changedTouches?e.changedTouches[0].pageX:e.pageX,pageY:e.changedTouches?e.changedTouches[0].pageY:e.pageY}}function M(e){var t=Ae(e),a=t.pageX-m.x,n=t.pageY-m.y;h&&(n+=h.scrollTop),pe(a,n),e.preventDefault(),e.stopPropagation()}function Ee(e,t){var a=y.style.left.replace("px","")*1+e,n=y.style.top.replace("px","")*1+t;pe(a,n)}function pe(e,t){e=e<0?0:e>m.width?m.width:e,t=t<0?0:t>m.height?m.height:t,y.style.left=e+"px",y.style.top=t+"px",de(e,t),y.focus()}function U(e,t){e===void 0&&(e={}),t===void 0&&(t={});var a=r.format;for(var n in e)f[n]=e[n];for(var i in t)f[i]=t[i];var u=Ne(f),d=u.substring(0,7);switch(y.style.color=d,D.parentNode.style.color=d,D.style.color=u,b.style.color=u,k.style.display="none",k.offsetHeight,k.style.display="",D.nextElementSibling.style.display="none",D.nextElementSibling.offsetHeight,D.nextElementSibling.style.display="",a==="mixed"?a=f.a===1?"hex":"rgb":a==="auto"&&(a=q),a){case"hex":w.value=u;break;case"rgb":w.value=De(f);break;case"hsl":w.value=Ge(Ie(f));break}l.querySelector('.clr-format [value="'+a+'"]').checked=!0}function Le(){var e=N.value*1,t=y.style.left.replace("px","")*1,a=y.style.top.replace("px","")*1;s.style.color="hsl("+e+", 100%, 50%)",_.style.left=e/360*100+"%",de(t,a)}function xe(){var e=O.value/100;D.style.left=e*100+"%",U({a:e}),H()}function Te(e){var t=e.s/100,a=e.v/100,n=t*a,i=e.h/60,u=n*(1-c.abs(i%2-1)),d=a-n;n=n+d,u=u+d;var F=c.floor(i)%6,v=[n,u,d,d,u,n][F],A=[u,n,n,u,d,d][F],B=[d,d,u,n,n,u][F];return{r:c.round(v*255),g:c.round(A*255),b:c.round(B*255),a:e.a}}function Ie(e){var t=e.v/100,a=t*(1-e.s/100/2),n;return a>0&&a<1&&(n=c.round((t-a)/c.min(a,1-a)*100)),{h:e.h,s:n||0,l:c.round(a*100),a:e.a}}function Se(e){var t=e.r/255,a=e.g/255,n=e.b/255,i=c.max(t,a,n),u=c.min(t,a,n),d=i-u,F=i,v=0,A=0;return d&&(i===t&&(v=(a-n)/d),i===a&&(v=2+(n-t)/d),i===n&&(v=4+(t-a)/d),i&&(A=d/i)),v=c.floor(v*60),{h:v<0?v+360:v,s:c.round(A*100),v:c.round(F*100),a:e.a}}function Be(e){var t=/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,a,n;return p.fillStyle="#000",p.fillStyle=e,a=t.exec(p.fillStyle),a?(n={r:a[3]*1,g:a[4]*1,b:a[5]*1,a:a[6]*1},n.a=+n.a.toFixed(2)):(a=p.fillStyle.replace("#","").match(/.{2}/g).map(function(i){return parseInt(i,16)}),n={r:a[0],g:a[1],b:a[2],a:1}),n}function Ne(e){var t=e.r.toString(16),a=e.g.toString(16),n=e.b.toString(16),i="";if(e.r<16&&(t="0"+t),e.g<16&&(a="0"+a),e.b<16&&(n="0"+n),r.alpha&&(e.a<1||r.forceAlpha)){var u=e.a*255|0;i=u.toString(16),u<16&&(i="0"+i)}return"#"+t+a+n+i}function De(e){return!r.alpha||e.a===1&&!r.forceAlpha?"rgb("+e.r+", "+e.g+", "+e.b+")":"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"}function Ge(e){return!r.alpha||e.a===1&&!r.forceAlpha?"hsl("+e.h+", "+e.s+"%, "+e.l+"%)":"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"}function He(){l.getElementById("clr-picker")||(h=null,s=l.createElement("div"),s.setAttribute("id","clr-picker"),s.className="clr-picker",s.innerHTML='<input id="clr-color-value" name="clr-color-value" class="clr-color" type="text" value="" spellcheck="false" aria-label="'+r.a11y.input+'">'+('<div id="clr-color-area" class="clr-gradient" role="application" aria-label="'+r.a11y.instruction+'">')+'<div id="clr-color-marker" class="clr-marker" tabindex="0"></div></div><div class="clr-hue">'+('<input id="clr-hue-slider" name="clr-hue-slider" type="range" min="0" max="360" step="1" aria-label="'+r.a11y.hueSlider+'">')+'<div id="clr-hue-marker"></div></div><div class="clr-alpha">'+('<input id="clr-alpha-slider" name="clr-alpha-slider" type="range" min="0" max="100" step="1" aria-label="'+r.a11y.alphaSlider+'">')+'<div id="clr-alpha-marker"></div><span></span></div><div id="clr-format" class="clr-format"><fieldset class="clr-segmented">'+("<legend>"+r.a11y.format+"</legend>")+'<input id="clr-f1" type="radio" name="clr-format" value="hex"><label for="clr-f1">Hex</label><input id="clr-f2" type="radio" name="clr-format" value="rgb"><label for="clr-f2">RGB</label><input id="clr-f3" type="radio" name="clr-format" value="hsl"><label for="clr-f3">HSL</label><span></span></fieldset></div><div id="clr-swatches" class="clr-swatches"></div>'+('<button type="button" id="clr-clear" class="clr-clear" aria-label="'+r.a11y.clear+'">'+r.clearLabel+"</button>")+'<div id="clr-color-preview" class="clr-preview">'+('<button type="button" id="clr-close" class="clr-close" aria-label="'+r.a11y.close+'">'+r.closeLabel+"</button>")+"</div>"+('<span id="clr-open-label" hidden>'+r.a11y.open+"</span>")+('<span id="clr-swatch-label" hidden>'+r.a11y.swatch+"</span>"),l.body.appendChild(s),k=E("clr-color-area"),y=E("clr-color-marker"),x=E("clr-clear"),T=E("clr-close"),b=E("clr-color-preview"),w=E("clr-color-value"),N=E("clr-hue-slider"),_=E("clr-hue-marker"),O=E("clr-alpha-slider"),D=E("clr-alpha-marker"),ee(r.el),z(r.el),g(s,"mousedown",function(e){s.classList.remove("clr-keyboard-nav"),e.stopPropagation()}),g(k,"mousedown",function(e){g(l,"mousemove",M)}),g(k,"touchstart",function(e){l.addEventListener("touchmove",M,{passive:!1})}),g(y,"mousedown",function(e){g(l,"mousemove",M)}),g(y,"touchstart",function(e){l.addEventListener("touchmove",M,{passive:!1})}),g(w,"change",function(e){(C||r.inline)&&(X(w.value),H())}),g(x,"click",function(e){H(""),P()}),g(T,"click",function(e){H(),P()}),g(l,"click",".clr-format input",function(e){q=e.target.value,U(),H()}),g(s,"click",".clr-swatches button",function(e){X(e.target.textContent),H(),r.swatchesOnly&&P()}),g(l,"mouseup",function(e){l.removeEventListener("mousemove",M)}),g(l,"touchend",function(e){l.removeEventListener("touchmove",M)}),g(l,"mousedown",function(e){J=!1,s.classList.remove("clr-keyboard-nav"),P()}),g(l,"keydown",function(e){var t=e.key,a=e.target,n=e.shiftKey,i=["Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"];if(t==="Escape"?P(!0):i.includes(t)&&(J=!0,s.classList.add("clr-keyboard-nav")),t==="Tab"&&a.matches(".clr-picker *")){var u=ve(),d=u.shift(),F=u.pop();n&&a===d?(F.focus(),e.preventDefault()):!n&&a===F&&(d.focus(),e.preventDefault())}}),g(l,"click",".clr-field button",function(e){j&&Z(),e.target.nextElementSibling.dispatchEvent(new Event("click",{bubbles:!0}))}),g(y,"keydown",function(e){var t={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};Object.keys(t).includes(e.key)&&(Ee.apply(void 0,t[e.key]),e.preventDefault())}),g(k,"click",M),g(N,"input",Le),g(O,"input",xe))}function ve(){var e=Array.from(s.querySelectorAll("input, button")),t=e.filter(function(a){return!!a.offsetWidth});return t}function E(e){return l.getElementById(e)}function g(e,t,a,n){var i=Element.prototype.matches||Element.prototype.msMatchesSelector;typeof a=="string"?e.addEventListener(t,function(u){i.call(u.target,a)&&n.call(u.target,u)}):(n=a,e.addEventListener(t,n))}function ae(e,t){t=t!==void 0?t:[],l.readyState!=="loading"?e.apply(void 0,t):l.addEventListener("DOMContentLoaded",function(){e.apply(void 0,t)})}NodeList!==void 0&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);function Me(e,t){C=t,G=C.value,ue(t),q=te(e),W(),X(e),H(),G!==e&&C.dispatchEvent(new Event("change",{bubbles:!0}))}var re=function(){var e={init:He,set:Y,wrap:z,close:P,setInstance:we,setColor:Me,removeInstance:Ce,updatePosition:W};function t(i){ae(function(){i&&(typeof i=="string"?ee(i):Y(i))})}var a=function(u){t[u]=function(){for(var d=arguments.length,F=new Array(d),v=0;v<d;v++)F[v]=arguments[v];ae(e[u],F)}};for(var n in e)a(n);return ae(function(){o.addEventListener("resize",function(i){t.updatePosition()}),o.addEventListener("scroll",function(i){t.updatePosition()})}),t}();return re.coloris=re,re}(window,document,Math)}();S.coloris;S.init;S.set;S.wrap;S.close;S.setInstance;S.removeInstance;S.updatePosition;S.init();S.coloris({el:".coloris",alpha:!1,format:"hex",wrap:!0,theme:"polaroid",themeMode:"light",swatches:["red","yellow","green","cyan","blue","purple"],onChange:o=>{console.log(o)}});S.close();document.querySelector("#app").innerHTML=`
  <div id="loadingApp" class="center">Loading...</div>
  <div id="labelApp" style="display:none;">
  <div id="buttonLabels">
  <div class="nameGroup center">
  <label for="gr1n">Group #1</label><br>
  <input type="text" id="gr1n" name="gr1n" maxlength="15" size="10">
  </div>
  <div class="nameGroup center">
  <label for="gr2n">Group #2</label><br>
  <input type="text" id="gr2n" name="gr2n" maxlength="15" size="10">
  </div>
  <div class="nameGroup center">
  <label for="gr3n">Group #3</label><br>
  <input type="text" id="gr3n" name="gr3n" maxlength="15" size="10">
  </div>
  </div>
  <div id="mainButtonsGroup" class="center"><label for="distance">Label Spacing: </label><input type="number" id="distance" name="distance"><div id="mainButtons"></div></div>
  <hr style="height:1px; visibility:hidden;" />
  <table id="table-one" style="width:100%">
  <thead>
  <tr>
  <th style="width: 5%">üîõ</th>
  <th style="width: 55%">Label Name</th>
  <th style="width: 10%">Group</th>
  <th style="width: 20%">Direction</th>
  <th style="width: 10%">üñçÔ∏è</th>
  </tr>
  </thead>
  <tbody id="label-list"></tbody>
  </table>
  </div>`;const be=document.getElementById("loadingApp"),Ve=document.getElementById("labelApp"),ge=document.getElementById("label-list"),ne=document.getElementById("mainButtons"),oe=document.getElementById("gr1n"),ce=document.getElementById("gr2n"),se=document.getElementById("gr3n"),R=document.getElementById("distance"),$e=[{Id:"1",Name:"Blinded üï∂Ô∏è",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"2",Name:"Charmed üíò",Color:"#ff0000",Group:"#1",Direction:"Top",Active:1},{Id:"3",Name:"Deafened üéß",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"4",Name:"Frightened üò±",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"5",Name:"Grappled ü´Ç",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"6",Name:"Incapacitated üíò",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"7",Name:"Invisible üò∂‚Äçüå´Ô∏è",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"8",Name:"Paralyzed ‚ö°",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"9",Name:"Petrified ü™®",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"10",Name:"Poisoned ü§¢",Color:"#008000",Group:"#1",Direction:"Top",Active:1},{Id:"11",Name:"Prone ü¶¶",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"12",Name:"Restrained ü™¢",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"13",Name:"Stunned üí´",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"14",Name:"Unconscious üí§",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"15",Name:"Exhaustion ü¶•",Color:"#FFFFFF",Group:"#1",Direction:"Top",Active:1},{Id:"16",Name:"Bardic Inspiration üéµ",Color:"#FFFFFF",Group:"#2",Direction:"Left",Active:1},{Id:"17",Name:"Champion üëë",Color:"#FFFFFF",Group:"#3",Direction:"Right",Active:1}],le=["Conditions","Buffs","Extra"],ye="35";I.onReady(async()=>{qe();const o=await I.theme.getTheme();me(o,document),I.theme.onChange(c=>{me(c,document)}),await I.player.getRole()==="GM"?await ze():(be.innerHTML="Configuration is GM-Access only.",await I.action.setHeight(70),await I.action.setWidth(150))});function ie(o){const l=ge.insertRow(0);l.id=Re();const c=l.insertCell(0),p=l.insertCell(1);p.id="name_"+l.id,p.setAttribute("contenteditable","true"),p.innerHTML=o?o.Name:"Default Name";const f=l.insertCell(2);f.className="center";const h=Xe();h.value=o?o.Group:"#1",h.id="group_"+l.id,f.appendChild(h);const s=l.insertCell(3);s.className="center";const k=We();k.value=o?o.Direction:"Top",k.id="selector_"+l.id,s.appendChild(k);const m=l.insertCell(4);m.id=l.id,m.className="center",c.innerHTML=`<input id="checkbox_${l.id}" type="checkbox" ${o?.Active===0?"":"checked"}/>`;const y=o?Oe(o.Color):void 0;m.appendChild(je(m.id,y))}function je(o,l){const c=document.createElement("div"),p=document.createElement("button");p.setAttribute("aria-labelledby","clr-open-label"),p.id="clr-button_"+o,c.className="clr-field",c.id="clr-field_"+o,c.style.color=l?"rgb"+l:"rgb(0, 0, 0)",c.appendChild(p);const f=document.createElement("input");return f.type="text",f.id="clr-input_"+o,f.style.width="20px",f.className="coloris",f.setAttribute("data-coloris",""),c.appendChild(f),c}function We(){const o=document.createElement("select");return["Top","Bottom","Left","Right"].forEach(c=>{const p=document.createElement("option");p.setAttribute("value",c);const f=document.createTextNode(c);p.appendChild(f),o.appendChild(p)}),o}function Xe(){const o=document.createElement("select");return["#1","#2","#3"].forEach(c=>{const p=document.createElement("option");p.setAttribute("value",c);const f=document.createTextNode(c);p.appendChild(f),o.appendChild(p)}),o}async function Fe(){const o=[],l=[],c=R.value;for(var p=document.getElementById("label-list"),f=0,h;h=p.rows[f];f++){const m=h.id,y=h.querySelector("#checkbox_"+m),b=h.querySelector("#name_"+m),w=h.querySelector("#selector_"+m),x=h.querySelector("#group_"+m),T=h.querySelector("#clr-field_"+m),N=Pe(T.style.color),_={Id:m,Active:y.checked?1:0,Name:b.innerHTML,Direction:w.value,Color:N,Group:x.value};o.push(_)}l.push({Name:oe.value,Num:"#1"}),l.push({Name:ce.value,Num:"#2"}),l.push({Name:se.value,Num:"#3"});const s={Groups:l,Labels:o,Distance:c};let k={};k[`${K.EXTENSIONID}/metadata_marks`]={saveData:s},await I.room.setMetadata(k)}async function Ye(){confirm("Erase everything and go back to default labels?")&&(ge.innerHTML="",await ke())}async function ke(){oe.value=le[0],ce.value=le[1],se.value=le[2],R.value=ye,$e.forEach(o=>{ie(o)}),await Fe()}async function ze(){const c=(await I.room.getMetadata())[`${K.EXTENSIONID}/metadata_marks`]?.saveData;c&&c.Labels?.length>0?(c.Labels.forEach(b=>{ie(b)}),c.Groups.forEach(b=>{switch(b.Num){case"#1":oe.value=b.Name;break;case"#2":ce.value=b.Name;break;case"#3":se.value=b.Name;break;default:throw new Error("Invalid Group")}})):await ke(),R.max="999",R.min="1",R.maxLength=4,R.value=c.Distance?c.Distance:ye,R.oninput=b=>{k(b.target)};const p=document.createElement("input");p.type="image",p.className="Icon clickable",p.id="saveButton",p.onclick=async function(){await Fe()},p.src="/save.svg",p.title="Save Changes",p.height=20,p.width=20,ne.appendChild(p);const f=document.createElement("input");f.type="image",f.className="Icon clickable",f.id="addButton",f.onclick=async function(){await ie()},f.src="/add.svg",f.title="Add Label",f.height=20,f.width=20,ne.appendChild(f);const h=document.createElement("input");h.type="image",h.className="Icon clickable",h.id="addButton",h.onclick=async function(){await Ye()},h.src="/reset.svg",h.title="Reset to Default Labels",h.height=20,h.width=20,ne.appendChild(h),be.style.display="none",Ve.style.display="";function s(b){return parseInt(b)}function k(b){let w=b.min,x=b.max,T=s(b.value);T>x?b.value=x:T<w&&(b.value=w)}function m(b){b.preventDefault();const w=b.target.closest("tr");w&&window.confirm(`Are you sure you want to delete ${w.children[1].innerHTML}?`)&&w.remove()}const y=document.getElementById("table-one");y&&y.addEventListener("contextmenu",m)}
